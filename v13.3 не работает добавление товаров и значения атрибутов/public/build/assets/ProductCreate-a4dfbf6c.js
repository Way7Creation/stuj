import{_ as re,g as f,p as se,h as ne,o as ae,r as ie,a as n,c as a,b as e,t as g,d as de,w as ue,e as me,m as b,s as ge,j as c,v as y,k as ce,F as x,l as v,z as T,y as be,x as ye,n as w}from"./main-9383d90c.js";const pe={name:"ProductCreate",setup(){const _=be(),t=ye(),k=f(!1),o=f(!1),V=se(()=>t.params.id?"edit":"create"),C=f([]),I=f([]),l=f([]),u=f([]),p=f(!1),U=f(null),S=f(null),m=ne({name:"",sku:"",description:"",price:0,stock_quantity:0,weight:0,use_matryoshka:!1,image_layers:{outer:"",inner:""},gallery_images:[""],theme_id:"",category_ids:[],attribute_values:{},meta_title:"",meta_description:"",dimensions:{length:0,width:0,height:0}}),N=async()=>{try{const r=await w.get("/admin/themes");C.value=r.data}catch(r){console.error("Ошибка загрузки тем:",r)}},M=async()=>{try{const r=await w.get("/admin/categories/tree");I.value=r.data}catch(r){console.error("Ошибка загрузки категорий:",r)}},D=async()=>{try{const r=await w.get("/admin/attributes");l.value=r.data}catch(r){console.error("Ошибка загрузки атрибутов:",r)}},P=async()=>{try{const r=await w.get("/admin/images");u.value=r.data}catch(r){console.error("Ошибка загрузки изображений:",r)}},q=async()=>{try{k.value=!0;const s=(await w.get(`/admin/products/${t.params.id}`)).data,i={};s.product_attributes&&s.product_attributes.forEach(d=>{d.attribute_value_id&&(i[d.attribute_id]||(i[d.attribute_id]=[]),i[d.attribute_id].push(d.attribute_value_id)),d.custom_value&&(i[`custom_${d.attribute_id}`]=d.custom_value)}),Object.assign(m,{...s,attribute_values:i})}catch(r){console.error("Ошибка загрузки товара:",r),alert("Ошибка загрузки товара"),_.push("/admin")}finally{k.value=!1}},G=(r,s)=>{m.attribute_values[r]||(m.attribute_values[r]=[]);const i=m.attribute_values[r],d=i.indexOf(s);d>-1?i.splice(d,1):i.push(s)},O=(r,s)=>{const i=m.attribute_values[r];return i&&i.includes(s)},F=r=>{var s;return((s=m.attribute_values[r])==null?void 0:s.customValue)||""},K=()=>{m.gallery_images.push("")},B=r=>{m.gallery_images.splice(r,1)},R=(r,s=null)=>{U.value=r,S.value=s,p.value=!0,P()},j=()=>{p.value=!1,U.value=null,S.value=null},z=r=>{const s=U.value;s==="outer"?m.image_layers.outer=r:s==="inner"?m.image_layers.inner=r:s==="gallery"&&(m.gallery_images[S.value]=r),j()},J=async r=>{const s=r.target.files;if(!s.length)return;const i=new FormData;for(let d of s)i.append("images[]",d);try{o.value=!0,await w.post("/admin/images/upload",i,{headers:{"Content-Type":"multipart/form-data"}}),alert("Изображения загружены!"),P()}catch(d){console.error("Ошибка загрузки изображений:",d),alert("Ошибка загрузки изображений")}finally{o.value=!1}},A=()=>{const r="STJ",s=Date.now().toString().slice(-6),i=Math.random().toString(36).substring(2,5).toUpperCase();m.sku=`${r}-${s}-${i}`},L=()=>{m.name&&!m.meta_title&&(m.meta_title=`${m.name} - купить в интернет-магазине Стужа`),m.description&&!m.meta_description&&(m.meta_description=m.description.substring(0,150)+"...")},H=r=>new Intl.NumberFormat("ru-RU").format(r),Q=r=>{const s=i=>{for(const d of i){if(d.id===r)return d.name;if(d.children){const h=s(d.children);if(h)return h}}return null};return s(I.value)||"Неизвестная категория"},W=r=>{const s=C.value.find(i=>i.id===r);return s?s.name:"Неизвестная тема"},X=r=>{const s=l.value.find(i=>i.id===parseInt(r));return s?s.name:"Неизвестный атрибут"},Y=(r,s)=>{const i=l.value.find(h=>h.id===parseInt(r));if(!i)return"";const d=[];return s.valueIds.forEach(h=>{const E=i.values.find(le=>le.id===h);E&&d.push(E.value)}),s.customValue&&d.push(`"${s.customValue}"`),d.join(", ")},Z=r=>`/storage/images/${r}`,$=r=>{r.target.src="/images/placeholder.jpg"},ee=()=>{window.open(`/product/${m.slug||m.name}`,"_blank")},te=async()=>{var r,s;try{k.value=!0;const i={...m,attributes:m.attribute_values},d=V.value==="edit",h=d?`/admin/products/${t.params.id}`:"/admin/products";await w[d?"put":"post"](h,i),alert(d?"Товар обновлен!":"Товар создан!"),_.push("/admin")}catch(i){console.error("Ошибка сохранения товара:",i);const d=((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Ошибка сохранения";alert("Ошибка: "+d)}finally{k.value=!1}},oe=async()=>{if(confirm("Вы уверены, что хотите удалить этот товар? Это действие нельзя отменить."))try{await w.delete(`/admin/products/${t.params.id}`),alert("Товар удален!"),_.push("/admin")}catch(r){console.error("Ошибка удаления товара:",r),alert("Ошибка удаления товара")}};return ae(async()=>{try{await Promise.all([N(),M(),D(),q()]),V.value==="create"&&!m.sku&&A()}catch(r){console.error("Ошибка инициализации:",r)}}),{loading:k,saving:o,mode:V,themes:C,categoryTree:I,attributes:l,availableImages:u,form:m,showImageSelector:p,toggleAttributeValue:G,setCustomAttributeValue,isAttributeValueSelected:O,getCustomAttributeValue:F,addGalleryImage:K,removeGalleryImage:B,openImageSelector:R,closeImageSelector:j,selectImage:z,uploadNewImages:J,generateSKU:A,generateMetaTags:L,formatPrice:H,getCategoryName:Q,getThemeName:W,getAttributeName:X,getAttributeDisplayValue:Y,getImageUrl:Z,handleImageError:$,previewProduct:ee,saveProduct:te,deleteProduct:oe}}},fe={class:"min-h-screen bg-gray-900 p-6"},xe={class:"max-w-7xl mx-auto"},ve={class:"flex justify-between items-center mb-8"},he={class:"text-3xl font-bold text-white"},we={class:"flex space-x-3"},_e={key:0,class:"flex justify-center items-center py-12"},ke={class:"lg:col-span-2 space-y-8"},Ie={class:"bg-gray-800 rounded-lg p-6"},Ve={class:"space-y-6"},Ce={class:"flex space-x-2"},Ue={class:"grid grid-cols-2 gap-4"},Se={class:"grid grid-cols-2 gap-4"},Ee=["value"],Te={class:"grid grid-cols-3 gap-4"},Pe={class:"bg-gray-800 rounded-lg p-6"},je={class:"mb-6"},Ae={class:"flex items-center space-x-3"},Ne={key:0,class:"space-y-4 mb-6"},Me={class:"flex space-x-4"},De={key:0,class:"mt-2"},qe=["src"],Ge={class:"flex space-x-4"},Oe={key:0,class:"mt-2"},Fe=["src"],Ke={key:1},Be={class:"space-y-4"},Re=["onUpdate:modelValue"],ze=["onClick"],Je=["onClick"],Le={key:0,class:"w-16 h-16"},He=["src","alt"],Qe={class:"mt-6 pt-6 border-t border-gray-700"},We={class:"bg-gray-800 rounded-lg p-6"},Xe={class:"space-y-4"},Ye={class:"text-xs text-gray-400 mt-1"},Ze={class:"text-xs text-gray-400 mt-1"},$e={class:"space-y-8"},et={class:"bg-gray-800 rounded-lg p-6"},tt={class:"space-y-2 max-h-64 overflow-y-auto"},ot={class:"flex items-center space-x-3 cursor-pointer p-2 hover:bg-gray-700 rounded"},lt=["value"],rt={class:"text-white"},st={class:"text-gray-400 text-sm"},nt={key:0,class:"ml-6 space-y-1"},at=["value"],it={class:"text-gray-300"},dt={class:"text-gray-400 text-sm"},ut={key:0,class:"text-gray-400 text-center py-4"},mt={class:"bg-gray-800 rounded-lg p-6"},gt={class:"space-y-6"},ct={class:"text-white font-medium mb-3 flex items-center space-x-2"},bt={key:0,class:"bg-purple-600 text-white px-2 py-1 rounded text-xs"},yt={key:0,class:"mb-4"},pt={class:"grid grid-cols-2 gap-2"},ft=["checked","onChange"],xt={class:"text-white text-sm"},vt=["value","onInput","placeholder"],ht={key:0,class:"text-gray-400 text-center py-4"},wt={class:"bg-gray-800 rounded-lg p-6"},_t={class:"space-y-3 text-sm"},kt={class:"text-white ml-2"},It={class:"text-white ml-2"},Vt={class:"text-white ml-2"},Ct={class:"ml-2 mt-1"},Ut={key:0,class:"text-gray-400"},St={class:"ml-2 mt-1 space-y-1"},Et={class:"text-gray-300"},Tt={class:"text-white ml-1"},Pt={key:1,class:"text-gray-400 text-xs"},jt={class:"bg-gray-800 rounded-lg p-6"},At={class:"space-y-4"},Nt=["disabled"],Mt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Dt={class:"bg-gray-800 rounded-lg p-6 max-w-4xl w-full max-h-96 overflow-hidden flex flex-col"},qt={class:"flex justify-between items-center mb-4"},Gt={class:"flex-1 overflow-y-auto"},Ot={class:"grid grid-cols-4 gap-4"},Ft=["onClick"],Kt=["src","alt"],Bt={class:"absolute bottom-1 left-1 right-1"},Rt={class:"text-white text-xs bg-black bg-opacity-50 p-1 rounded truncate"};function zt(_,t,k,o,V,C){const I=ie("router-link");return n(),a("div",fe,[e("div",xe,[e("div",ve,[e("div",null,[e("h1",he,g(o.mode==="edit"?"Редактировать товар":"Создать новый товар"),1),t[33]||(t[33]=e("p",{class:"text-gray-400 mt-1"},"Заполните информацию о товаре",-1))]),e("div",we,[de(I,{to:"/admin",class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"},{default:ue(()=>t[34]||(t[34]=[me(" ← Назад к админке ")])),_:1,__:[34]}),o.mode==="edit"?(n(),a("button",{key:0,onClick:t[0]||(t[0]=(...l)=>o.previewProduct&&o.previewProduct(...l)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"}," Предпросмотр ")):b("",!0)])]),o.loading?(n(),a("div",_e,t[35]||(t[35]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"},null,-1)]))):(n(),a("form",{key:1,onSubmit:t[30]||(t[30]=ge((...l)=>o.saveProduct&&o.saveProduct(...l),["prevent"])),class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},[e("div",ke,[e("div",Ie,[t[45]||(t[45]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Основная информация",-1)),e("div",Ve,[e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Название товара * ",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.form.name=l),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Например: Кольцо с агатом",onInput:t[2]||(t[2]=(...l)=>o.generateMetaTags&&o.generateMetaTags(...l))},null,544),[[y,o.form.name]])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Артикул (SKU) ",-1)),e("div",Ce,[c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>o.form.sku=l),type:"text",class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Будет сгенерирован автоматически"},null,512),[[y,o.form.sku]]),e("button",{type:"button",onClick:t[4]||(t[4]=(...l)=>o.generateSKU&&o.generateSKU(...l)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors"}," Генерировать ")])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Описание * ",-1)),c(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>o.form.description=l),required:"",rows:"4",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Подробное описание товара...",onInput:t[6]||(t[6]=(...l)=>o.generateMetaTags&&o.generateMetaTags(...l))},null,544),[[y,o.form.description]])]),e("div",Ue,[e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Цена (рубли) * ",-1)),c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>o.form.price=l),type:"number",required:"",min:"0",step:"0.01",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"0.00"},null,512),[[y,o.form.price,void 0,{number:!0}]])]),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Количество в наличии ",-1)),c(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>o.form.stock_quantity=l),type:"number",min:"0",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"0"},null,512),[[y,o.form.stock_quantity,void 0,{number:!0}]])])]),e("div",Se,[e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Вес (граммы) ",-1)),c(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>o.form.weight=l),type:"number",min:"0",step:"0.1",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"0.0"},null,512),[[y,o.form.weight,void 0,{number:!0}]])]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Тема оформления * ",-1)),c(e("select",{"onUpdate:modelValue":t[10]||(t[10]=l=>o.form.theme_id=l),required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-blue-500 focus:outline-none"},[t[42]||(t[42]=e("option",{value:""},"Выберите тему",-1)),(n(!0),a(x,null,v(o.themes,l=>(n(),a("option",{key:l.id,value:l.id},g(l.name),9,Ee))),128))],512),[[ce,o.form.theme_id]])])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Размеры (мм) ",-1)),e("div",Te,[e("div",null,[c(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>o.form.dimensions.length=l),type:"number",min:"0",step:"0.1",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Длина"},null,512),[[y,o.form.dimensions.length,void 0,{number:!0}]])]),e("div",null,[c(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>o.form.dimensions.width=l),type:"number",min:"0",step:"0.1",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Ширина"},null,512),[[y,o.form.dimensions.width,void 0,{number:!0}]])]),e("div",null,[c(e("input",{"onUpdate:modelValue":t[13]||(t[13]=l=>o.form.dimensions.height=l),type:"number",min:"0",step:"0.1",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Высота"},null,512),[[y,o.form.dimensions.height,void 0,{number:!0}]])])])])])]),e("div",Pe,[t[52]||(t[52]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Изображения",-1)),e("div",je,[e("label",Ae,[c(e("input",{"onUpdate:modelValue":t[14]||(t[14]=l=>o.form.use_matryoshka=l),type:"checkbox",class:"rounded"},null,512),[[T,o.form.use_matryoshka]]),t[46]||(t[46]=e("span",{class:"text-white font-medium"},"Использовать эффект матрёшки",-1)),t[47]||(t[47]=e("span",{class:"text-gray-400 text-sm"},"(два слоя изображений)",-1))])]),o.form.use_matryoshka?(n(),a("div",Ne,[e("div",null,[t[48]||(t[48]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Внешний слой матрёшки ",-1)),e("div",Me,[c(e("input",{"onUpdate:modelValue":t[15]||(t[15]=l=>o.form.image_layers.outer=l),type:"text",class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Имя файла внешнего слоя"},null,512),[[y,o.form.image_layers.outer]]),e("button",{type:"button",onClick:t[16]||(t[16]=l=>o.openImageSelector("outer")),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors"}," Выбрать ")]),o.form.image_layers.outer?(n(),a("div",De,[e("img",{src:o.getImageUrl(o.form.image_layers.outer),alt:"Внешний слой",class:"w-32 h-32 object-cover rounded-lg",onError:t[17]||(t[17]=(...l)=>o.handleImageError&&o.handleImageError(...l))},null,40,qe)])):b("",!0)]),e("div",null,[t[49]||(t[49]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Внутренний слой матрёшки ",-1)),e("div",Ge,[c(e("input",{"onUpdate:modelValue":t[18]||(t[18]=l=>o.form.image_layers.inner=l),type:"text",class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Имя файла внутреннего слоя"},null,512),[[y,o.form.image_layers.inner]]),e("button",{type:"button",onClick:t[19]||(t[19]=l=>o.openImageSelector("inner")),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors"}," Выбрать ")]),o.form.image_layers.inner?(n(),a("div",Oe,[e("img",{src:o.getImageUrl(o.form.image_layers.inner),alt:"Внутренний слой",class:"w-32 h-32 object-cover rounded-lg",onError:t[20]||(t[20]=(...l)=>o.handleImageError&&o.handleImageError(...l))},null,40,Fe)])):b("",!0)])])):(n(),a("div",Ke,[t[50]||(t[50]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Галерея изображений ",-1)),e("div",Be,[(n(!0),a(x,null,v(o.form.gallery_images,(l,u)=>(n(),a("div",{key:u,class:"flex items-center space-x-4"},[c(e("input",{"onUpdate:modelValue":p=>o.form.gallery_images[u]=p,type:"text",class:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Имя файла изображения"},null,8,Re),[[y,o.form.gallery_images[u]]]),e("button",{type:"button",onClick:p=>o.openImageSelector("gallery",u),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors"}," Выбрать ",8,ze),e("button",{type:"button",onClick:p=>o.removeGalleryImage(u),class:"bg-red-600 hover:bg-red-700 text-white px-4 py-3 rounded-lg transition-colors"}," Удалить ",8,Je),l?(n(),a("div",Le,[e("img",{src:o.getImageUrl(l),alt:`Изображение ${u+1}`,class:"w-full h-full object-cover rounded-lg",onError:t[21]||(t[21]=(...p)=>o.handleImageError&&o.handleImageError(...p))},null,40,He)])):b("",!0)]))),128)),e("button",{type:"button",onClick:t[22]||(t[22]=(...l)=>o.addGalleryImage&&o.addGalleryImage(...l)),class:"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg transition-colors"}," + Добавить изображение ")])])),e("div",Qe,[t[51]||(t[51]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Загрузить новые изображения",-1)),e("input",{ref:"imageUpload",type:"file",multiple:"",accept:"image/*",onChange:t[23]||(t[23]=(...l)=>o.uploadNewImages&&o.uploadNewImages(...l)),class:"hidden"},null,544),e("button",{type:"button",onClick:t[24]||(t[24]=l=>_.$refs.imageUpload.click()),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg transition-colors"}," Выбрать файлы для загрузки ")])]),e("div",We,[t[55]||(t[55]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"SEO и мета-теги",-1)),e("div",Xe,[e("div",null,[t[53]||(t[53]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Мета-заголовок ",-1)),c(e("input",{"onUpdate:modelValue":t[25]||(t[25]=l=>o.form.meta_title=l),type:"text",maxlength:"60",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Автоматически генерируется из названия"},null,512),[[y,o.form.meta_title]]),e("div",Ye,g(o.form.meta_title.length)+"/60 символов ",1)]),e("div",null,[t[54]||(t[54]=e("label",{class:"block text-sm font-medium text-white mb-2"}," Мета-описание ",-1)),c(e("textarea",{"onUpdate:modelValue":t[26]||(t[26]=l=>o.form.meta_description=l),rows:"3",maxlength:"160",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:"Автоматически генерируется из описания"},null,512),[[y,o.form.meta_description]]),e("div",Ze,g(o.form.meta_description.length)+"/160 символов ",1)])])])]),e("div",$e,[e("div",et,[t[56]||(t[56]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Категории",-1)),e("div",tt,[(n(!0),a(x,null,v(o.categoryTree,l=>(n(),a("div",{key:l.id,class:"space-y-1"},[e("label",ot,[c(e("input",{"onUpdate:modelValue":t[27]||(t[27]=u=>o.form.category_ids=u),value:l.id,type:"checkbox",class:"rounded"},null,8,lt),[[T,o.form.category_ids]]),e("span",rt,g(l.name),1),e("span",st,"("+g(l.products_count||0)+")",1)]),l.children&&l.children.length?(n(),a("div",nt,[(n(!0),a(x,null,v(l.children,u=>(n(),a("label",{key:u.id,class:"flex items-center space-x-3 cursor-pointer p-2 hover:bg-gray-700 rounded"},[c(e("input",{"onUpdate:modelValue":t[28]||(t[28]=p=>o.form.category_ids=p),value:u.id,type:"checkbox",class:"rounded"},null,8,at),[[T,o.form.category_ids]]),e("span",it,"→ "+g(u.name),1),e("span",dt,"("+g(u.products_count||0)+")",1)]))),128))])):b("",!0)]))),128))]),o.categoryTree.length?b("",!0):(n(),a("div",ut," Нет доступных категорий "))]),e("div",mt,[t[59]||(t[59]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Атрибуты товара",-1)),e("div",gt,[(n(!0),a(x,null,v(o.attributes,l=>(n(),a("div",{key:l.id,class:"border border-gray-700 rounded-lg p-4"},[e("h3",ct,[e("span",null,g(l.name),1),l.is_stone?(n(),a("span",bt," Камень ")):b("",!0)]),l.values&&l.values.length?(n(),a("div",yt,[t[57]||(t[57]=e("label",{class:"block text-sm text-gray-300 mb-2"},"Стандартные значения:",-1)),e("div",pt,[(n(!0),a(x,null,v(l.values,u=>(n(),a("label",{key:u.id,class:"flex items-center space-x-2 cursor-pointer p-2 hover:bg-gray-700 rounded"},[e("input",{checked:o.isAttributeValueSelected(l.id,u.id),onChange:p=>o.toggleAttributeValue(l.id,u.id),type:"checkbox",class:"rounded"},null,40,ft),e("span",xt,g(u.value),1)]))),128))])])):b("",!0),e("div",null,[t[58]||(t[58]=e("label",{class:"block text-sm text-gray-300 mb-2"},"Или введите кастомное значение:",-1)),e("input",{value:o.getCustomAttributeValue(l.id),onInput:u=>o.setCustomAttributeValue(l.id,u.target.value),type:"text",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none",placeholder:`Кастомное значение для ${l.name}`},null,40,vt)])]))),128))]),o.attributes.length?b("",!0):(n(),a("div",ht," Нет доступных атрибутов "))]),e("div",wt,[t[65]||(t[65]=e("h2",{class:"text-xl font-semibold text-white mb-4"},"Предпросмотр",-1)),e("div",_t,[e("div",null,[t[60]||(t[60]=e("span",{class:"text-gray-400"},"Название:",-1)),e("span",kt,g(o.form.name||"Не указано"),1)]),e("div",null,[t[61]||(t[61]=e("span",{class:"text-gray-400"},"Цена:",-1)),e("span",It,g(o.formatPrice(o.form.price))+" ₽",1)]),e("div",null,[t[62]||(t[62]=e("span",{class:"text-gray-400"},"Тема:",-1)),e("span",Vt,g(o.getThemeName(o.form.theme_id)),1)]),e("div",null,[t[63]||(t[63]=e("span",{class:"text-gray-400"},"Категории:",-1)),e("div",Ct,[(n(!0),a(x,null,v(o.form.category_ids,l=>(n(),a("span",{key:l,class:"inline-block bg-blue-600 text-white px-2 py-1 rounded text-xs mr-1 mb-1"},g(o.getCategoryName(l)),1))),128)),o.form.category_ids.length?b("",!0):(n(),a("span",Ut,"Не выбраны"))])]),e("div",null,[t[64]||(t[64]=e("span",{class:"text-gray-400"},"Атрибуты:",-1)),e("div",St,[_.values.valueIds.length>0||_.values.customValue?(n(!0),a(x,{key:0},v(Object.entries(o.form.attribute_values),([l,u])=>(n(),a("div",{key:l,class:"text-xs"},[e("span",Et,g(o.getAttributeName(l))+":",1),e("span",Tt,g(o.getAttributeDisplayValue(l,u)),1)]))),128)):b("",!0),Object.keys(o.form.attribute_values).length?b("",!0):(n(),a("span",Pt," Не указаны "))])])])]),e("div",jt,[e("div",At,[e("button",{type:"submit",class:"w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg transition-colors font-medium",disabled:o.saving},g(o.saving?"Сохранение...":o.mode==="edit"?"Обновить товар":"Создать товар"),9,Nt),o.mode==="edit"?(n(),a("button",{key:0,type:"button",onClick:t[29]||(t[29]=(...l)=>o.deleteProduct&&o.deleteProduct(...l)),class:"w-full bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg transition-colors"}," Удалить товар ")):b("",!0)])])])],32))]),o.showImageSelector?(n(),a("div",Mt,[e("div",Dt,[e("div",qt,[t[66]||(t[66]=e("h3",{class:"text-xl text-white"},"Выберите изображение",-1)),e("button",{onClick:t[31]||(t[31]=(...l)=>o.closeImageSelector&&o.closeImageSelector(...l)),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Закрыть ")]),e("div",Gt,[e("div",Ot,[(n(!0),a(x,null,v(o.availableImages,l=>(n(),a("div",{key:l.filename,class:"relative cursor-pointer group",onClick:u=>o.selectImage(l.filename)},[e("img",{src:o.getImageUrl(l.filename),alt:l.filename,class:"w-full h-24 object-cover rounded-lg group-hover:opacity-75 transition-opacity",onError:t[32]||(t[32]=(...u)=>o.handleImageError&&o.handleImageError(...u))},null,40,Kt),t[67]||(t[67]=e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-25 rounded-lg transition-opacity"},null,-1)),e("div",Bt,[e("p",Rt,g(l.filename),1)])],8,Ft))),128))])])])])):b("",!0)])}const Lt=re(pe,[["render",zt],["__scopeId","data-v-7a7fcfe3"]]);export{Lt as default};
