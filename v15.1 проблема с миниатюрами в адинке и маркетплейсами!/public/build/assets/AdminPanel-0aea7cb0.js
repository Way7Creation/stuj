import{_ as je,g as F,o as Qe,n as M,a as p,c as v,b as r,F as K,l as Z,t as b,q as kt,j as rt,k as Bt,m as B,z as Fn,A as Be,r as Te,i as Pn,s as vt,B as Nn,d as ne,w as Ie,C as jn,h as Kt,p as Vn,e as Zt,v as St,D as Ln,y as Rn}from"./main-86cfeee4.js";const Un={class:"marketplace-manager"},Bn={class:"mb-8"},Xn={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Yn={class:"flex items-center justify-between mb-3"},zn={class:"text-lg font-medium text-white"},$n={class:"space-y-2 text-sm"},Hn={class:"flex justify-between"},Gn={class:"text-white"},Wn={class:"flex justify-between"},qn={class:"text-white"},Kn={class:"mt-4 space-y-2"},Zn=["onClick"],Jn=["onClick","disabled"],Qn={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},to={class:"bg-gray-800 rounded-lg p-6"},eo={key:0,class:"space-y-3"},no={class:"flex justify-between"},oo={class:"text-white"},ro={class:"flex justify-between"},io={class:"text-white"},so={class:"flex justify-between"},ao={class:"text-red-400"},lo={class:"flex justify-between"},uo={class:"text-yellow-400"},co={key:1,class:"text-gray-500 text-center py-8"},fo={class:"bg-gray-800 rounded-lg p-6"},go={key:0,class:"space-y-3 max-h-64 overflow-y-auto"},ho={class:"flex justify-between items-start"},mo={class:"text-white text-sm"},po={class:"text-gray-500 text-xs"},vo={key:1,class:"text-gray-500 text-center py-8"},bo={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},yo={class:"bg-gray-800 rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto"},xo={class:"flex justify-between items-center mb-4"},_o={class:"text-xl font-semibold text-white"},wo={class:"bg-gray-700 rounded-lg p-4 mb-6"},ko={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Eo=["value"],Co=["value"],Do={class:"flex items-end"},So=["disabled"],To={key:0,class:"space-y-2"},Io={class:"text-white"},Ao={class:"text-white"},Oo=["onClick"],Mo={key:1,class:"text-gray-500 text-center py-4"},Fo={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Po={class:"bg-gray-800 rounded-lg p-6 max-w-2xl w-full"},No={class:"space-y-3"},jo={class:"flex justify-between"},Vo={class:"text-green-400 font-semibold"},Lo={class:"flex justify-between"},Ro={class:"text-red-400 font-semibold"},Uo={key:0,class:"mt-4"},Bo={class:"bg-gray-700 rounded-lg p-3 max-h-48 overflow-y-auto"},Xo={class:"text-red-400"},Yo={class:"text-gray-300 ml-2"},zo={class:"mt-6 flex justify-end"},$o={__name:"MarketplaceManager",setup(n){const t=F([]),o=F(null),e=F(null),i=F([]),a=F([]),l=F([]),d=F([]),u=F(!1),c=F(!1),s=F(null),f=F(!1),w=F({}),C=F({our_attr_id:"",marketplace_attr_name:""});Qe(()=>{D(),_()});const D=async()=>{try{const A=await M.get("/admin/marketplace");t.value=A.data.marketplaces}catch(A){console.error("Ошибка загрузки маркетплейсов:",A)}},_=async()=>{try{const A=await M.get("/admin/marketplace/sync-log");i.value=A.data.logs}catch(A){console.error("Ошибка загрузки логов:",A)}},y=async A=>{s.value=A,u.value=!0;try{const g=await M.get(`/admin/marketplace/${A}/mappings`);a.value=g.data.mappings,l.value=g.data.our_attributes,d.value=g.data.marketplace_attributes}catch(g){console.error("Ошибка загрузки маппингов:",g)}},S=()=>{u.value=!1,s.value=null,C.value={our_attr_id:"",marketplace_attr_name:""}},I=async()=>{try{await M.post("/admin/marketplace/mapping",{marketplace:s.value,our_attr_id:C.value.our_attr_id,marketplace_attr_name:C.value.marketplace_attr_name}),y(s.value),C.value={our_attr_id:"",marketplace_attr_name:""}}catch(A){console.error("Ошибка сохранения маппинга:",A),alert("Ошибка сохранения маппинга")}},N=async A=>{if(confirm("Удалить этот маппинг?"))try{await M.delete(`/admin/marketplace/mapping/${A}`),y(s.value)}catch(g){console.error("Ошибка удаления маппинга:",g),alert("Ошибка удаления маппинга")}},L=async A=>{var g,x;if(confirm("Начать синхронизацию всех товаров с маркетплейсом?")){f.value=!0;try{const V=await M.post("/admin/marketplace/sync",{marketplace:A});w.value=V.data.results,c.value=!0,D(),_()}catch(V){console.error("Ошибка синхронизации:",V),alert("Ошибка синхронизации: "+((x=(g=V.response)==null?void 0:g.data)==null?void 0:x.error)||V.message)}finally{f.value=!1}}},W=A=>A?new Date(A).toLocaleString("ru-RU"):"Никогда",X=A=>{const g=t.value.find(x=>x.id===A);return(g==null?void 0:g.name)||A},dt=A=>{const g=d.value.find(x=>x.id===A);return(g==null?void 0:g.name)||A};return(A,g)=>(p(),v("div",Un,[r("div",Bn,[g[5]||(g[5]=r("h2",{class:"text-xl font-semibold text-white mb-4"},"Маркетплейсы",-1)),r("div",Xn,[(p(!0),v(K,null,Z(t.value,x=>(p(),v("div",{key:x.id,class:"bg-gray-800 rounded-lg p-4 border border-gray-700"},[r("div",Yn,[r("h3",zn,b(x.name),1),r("span",{class:kt(["px-2 py-1 rounded text-xs font-medium",x.configured?"bg-green-600 text-green-100":"bg-red-600 text-red-100"])},b(x.configured?"Настроен":"Не настроен"),3)]),r("div",$n,[r("div",Hn,[g[3]||(g[3]=r("span",{class:"text-gray-400"},"Товаров синхронизировано:",-1)),r("span",Gn,b(x.products_count),1)]),r("div",Wn,[g[4]||(g[4]=r("span",{class:"text-gray-400"},"Последняя синхронизация:",-1)),r("span",qn,b(W(x.last_sync)),1)])]),r("div",Kn,[r("button",{onClick:V=>y(x.id),class:"w-full bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm transition-colors"}," Настроить маппинг ",8,Zn),r("button",{onClick:V=>L(x.id),disabled:!x.configured||f.value,class:"w-full bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},b(f.value?"Синхронизация...":"Синхронизировать"),9,Jn)])]))),128))])]),r("div",Qn,[r("div",to,[g[10]||(g[10]=r("h3",{class:"text-lg font-medium text-white mb-4"},"Статистика синхронизации",-1)),o.value&&e.value?(p(),v("div",eo,[r("div",no,[g[6]||(g[6]=r("span",{class:"text-gray-400"},"Всего товаров:",-1)),r("span",oo,b(e.value.total_products),1)]),r("div",ro,[g[7]||(g[7]=r("span",{class:"text-gray-400"},"Синхронизировано:",-1)),r("span",io,b(e.value.synced_products),1)]),r("div",so,[g[8]||(g[8]=r("span",{class:"text-gray-400"},"Ошибок синхронизации:",-1)),r("span",ao,b(e.value.sync_errors),1)]),r("div",lo,[g[9]||(g[9]=r("span",{class:"text-gray-400"},"Ожидают обновления:",-1)),r("span",uo,b(e.value.pending_updates),1)])])):(p(),v("div",co," Выберите маркетплейс для просмотра статистики "))]),r("div",fo,[g[11]||(g[11]=r("h3",{class:"text-lg font-medium text-white mb-4"},"Последние действия",-1)),i.value.length>0?(p(),v("div",go,[(p(!0),v(K,null,Z(i.value,x=>(p(),v("div",{key:x.id,class:kt(["border-l-4 pl-3 py-2",{"border-green-500":x.status==="success","border-red-500":x.status==="error","border-yellow-500":x.status==="warning"}])},[r("div",ho,[r("div",null,[r("p",mo,b(x.message),1),r("p",po,b(X(x.marketplace))+" • "+b(W(x.created_at)),1)]),r("span",{class:kt(["text-xs px-2 py-1 rounded",{"bg-green-600 text-green-100":x.status==="success","bg-red-600 text-red-100":x.status==="error","bg-yellow-600 text-yellow-100":x.status==="warning"}])},b(x.status),3)])],2))),128))])):(p(),v("div",vo," Нет логов "))])]),u.value?(p(),v("div",bo,[r("div",yo,[r("div",xo,[r("h3",_o," Маппинг атрибутов - "+b(X(s.value)),1),r("button",{onClick:S,class:"text-gray-400 hover:text-white"},g[12]||(g[12]=[r("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),r("div",wo,[g[17]||(g[17]=r("h4",{class:"text-md font-medium text-white mb-3"},"Добавить маппинг",-1)),r("div",ko,[r("div",null,[g[14]||(g[14]=r("label",{class:"block text-sm font-medium text-white mb-2"}," Наш атрибут ",-1)),rt(r("select",{"onUpdate:modelValue":g[0]||(g[0]=x=>C.value.our_attr_id=x),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white"},[g[13]||(g[13]=r("option",{value:""},"Выберите атрибут",-1)),(p(!0),v(K,null,Z(l.value,x=>(p(),v("option",{key:x.id,value:x.id},b(x.name),9,Eo))),128))],512),[[Bt,C.value.our_attr_id]])]),r("div",null,[g[16]||(g[16]=r("label",{class:"block text-sm font-medium text-white mb-2"}," Атрибут маркетплейса ",-1)),rt(r("select",{"onUpdate:modelValue":g[1]||(g[1]=x=>C.value.marketplace_attr_name=x),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white"},[g[15]||(g[15]=r("option",{value:""},"Выберите атрибут",-1)),(p(!0),v(K,null,Z(d.value,x=>(p(),v("option",{key:x.id,value:x.id},b(x.name),9,Co))),128))],512),[[Bt,C.value.marketplace_attr_name]])]),r("div",Do,[r("button",{onClick:I,disabled:!C.value.our_attr_id||!C.value.marketplace_attr_name,class:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50"}," Добавить ",8,So)])])]),r("div",null,[g[20]||(g[20]=r("h4",{class:"text-md font-medium text-white mb-3"},"Существующие маппинги",-1)),a.value.length>0?(p(),v("div",To,[(p(!0),v(K,null,Z(a.value,x=>{var V;return p(),v("div",{key:x.id,class:"bg-gray-700 rounded-lg p-3 flex justify-between items-center"},[r("div",null,[r("span",Io,b(((V=x.attribute)==null?void 0:V.name)||"Неизвестный атрибут"),1),g[18]||(g[18]=r("span",{class:"text-gray-400 mx-2"},"→",-1)),r("span",Ao,b(dt(x.marketplace_attr_name)),1)]),r("button",{onClick:ut=>N(x.id),class:"text-red-400 hover:text-red-300"},g[19]||(g[19]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Oo)])}),128))])):(p(),v("div",Mo," Нет настроенных маппингов "))])])])):B("",!0),c.value?(p(),v("div",Fo,[r("div",Po,[g[24]||(g[24]=r("h3",{class:"text-xl font-semibold text-white mb-4"},"Результаты синхронизации",-1)),r("div",No,[r("div",jo,[g[21]||(g[21]=r("span",{class:"text-gray-400"},"Успешно синхронизировано:",-1)),r("span",Vo,b(w.value.success),1)]),r("div",Lo,[g[22]||(g[22]=r("span",{class:"text-gray-400"},"Ошибок:",-1)),r("span",Ro,b(w.value.failed),1)])]),w.value.errors&&w.value.errors.length>0?(p(),v("div",Uo,[g[23]||(g[23]=r("h4",{class:"text-md font-medium text-white mb-2"},"Ошибки:",-1)),r("div",Bo,[(p(!0),v(K,null,Z(w.value.errors,(x,V)=>(p(),v("div",{key:V,class:"text-sm mb-2"},[r("span",Xo,b(x.product_name)+":",1),r("span",Yo,b(x.error),1)]))),128))])])):B("",!0),r("div",zo,[r("button",{onClick:g[2]||(g[2]=x=>c.value=!1),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"}," Закрыть ")])])])):B("",!0)]))}},Ho=je($o,[["__scopeId","data-v-8fabe975"]]);/*!
  * vue-draggable-next v2.2.0
  * (c) 2023 Anish George
  * @license MIT
  *//**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Xe(n,t){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),o.push.apply(o,e)}return o}function pt(n){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Xe(Object(o),!0).forEach(function(e){Go(n,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):Xe(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function oe(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?oe=function(t){return typeof t}:oe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(n)}function Go(n,t,o){return t in n?Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[t]=o,n}function yt(){return yt=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(n[e]=o[e])}return n},yt.apply(this,arguments)}function Wo(n,t){if(n==null)return{};var o={},e=Object.keys(n),i,a;for(a=0;a<e.length;a++)i=e[a],!(t.indexOf(i)>=0)&&(o[i]=n[i]);return o}function qo(n,t){if(n==null)return{};var o=Wo(n,t),e,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(i=0;i<a.length;i++)e=a[i],!(t.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(n,e)&&(o[e]=n[e])}return o}var Ko="1.14.0";function bt(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var xt=bt(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Gt=bt(/Edge/i),Ye=bt(/firefox/i),Xt=bt(/safari/i)&&!bt(/chrome/i)&&!bt(/android/i),tn=bt(/iP(ad|od|hone)/i),Zo=bt(/chrome/i)&&bt(/android/i),en={capture:!1,passive:!1};function j(n,t,o){n.addEventListener(t,o,!xt&&en)}function P(n,t,o){n.removeEventListener(t,o,!xt&&en)}function le(n,t){if(t){if(t[0]===">"&&(t=t.substring(1)),n)try{if(n.matches)return n.matches(t);if(n.msMatchesSelector)return n.msMatchesSelector(t);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(t)}catch{return!1}return!1}}function Jo(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function ht(n,t,o,e){if(n){o=o||document;do{if(t!=null&&(t[0]===">"?n.parentNode===o&&le(n,t):le(n,t))||e&&n===o)return n;if(n===o)break}while(n=Jo(n))}return null}var ze=/\s+/g;function ot(n,t,o){if(n&&t)if(n.classList)n.classList[o?"add":"remove"](t);else{var e=(" "+n.className+" ").replace(ze," ").replace(" "+t+" "," ");n.className=(e+(o?" "+t:"")).replace(ze," ")}}function k(n,t,o){var e=n&&n.style;if(e){if(o===void 0)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(o=n.currentStyle),t===void 0?o:o[t];!(t in e)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),e[t]=o+(typeof o=="string"?"":"px")}}function jt(n,t){var o="";if(typeof n=="string")o=n;else do{var e=k(n,"transform");e&&e!=="none"&&(o=e+" "+o)}while(!t&&(n=n.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(o)}function nn(n,t,o){if(n){var e=n.getElementsByTagName(t),i=0,a=e.length;if(o)for(;i<a;i++)o(e[i],i);return e}return[]}function mt(){var n=document.scrollingElement;return n||document.documentElement}function G(n,t,o,e,i){if(!(!n.getBoundingClientRect&&n!==window)){var a,l,d,u,c,s,f;if(n!==window&&n.parentNode&&n!==mt()?(a=n.getBoundingClientRect(),l=a.top,d=a.left,u=a.bottom,c=a.right,s=a.height,f=a.width):(l=0,d=0,u=window.innerHeight,c=window.innerWidth,s=window.innerHeight,f=window.innerWidth),(t||o)&&n!==window&&(i=i||n.parentNode,!xt))do if(i&&i.getBoundingClientRect&&(k(i,"transform")!=="none"||o&&k(i,"position")!=="static")){var w=i.getBoundingClientRect();l-=w.top+parseInt(k(i,"border-top-width")),d-=w.left+parseInt(k(i,"border-left-width")),u=l+a.height,c=d+a.width;break}while(i=i.parentNode);if(e&&n!==window){var C=jt(i||n),D=C&&C.a,_=C&&C.d;C&&(l/=_,d/=D,f/=D,s/=_,u=l+s,c=d+f)}return{top:l,left:d,bottom:u,right:c,width:f,height:s}}}function $e(n,t,o){for(var e=Et(n,!0),i=G(n)[t];e;){var a=G(e)[o],l=void 0;if(o==="top"||o==="left"?l=i>=a:l=i<=a,!l)return e;if(e===mt())break;e=Et(e,!1)}return!1}function Vt(n,t,o,e){for(var i=0,a=0,l=n.children;a<l.length;){if(l[a].style.display!=="none"&&l[a]!==E.ghost&&(e||l[a]!==E.dragged)&&ht(l[a],o.draggable,n,!1)){if(i===t)return l[a];i++}a++}return null}function Ve(n,t){for(var o=n.lastElementChild;o&&(o===E.ghost||k(o,"display")==="none"||t&&!le(o,t));)o=o.previousElementSibling;return o||null}function lt(n,t){var o=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==E.clone&&(!t||le(n,t))&&o++;return o}function He(n){var t=0,o=0,e=mt();if(n)do{var i=jt(n),a=i.a,l=i.d;t+=n.scrollLeft*a,o+=n.scrollTop*l}while(n!==e&&(n=n.parentNode));return[t,o]}function Qo(n,t){for(var o in n)if(n.hasOwnProperty(o)){for(var e in t)if(t.hasOwnProperty(e)&&t[e]===n[o][e])return Number(o)}return-1}function Et(n,t){if(!n||!n.getBoundingClientRect)return mt();var o=n,e=!1;do if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var i=k(o);if(o.clientWidth<o.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||o.clientHeight<o.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!o.getBoundingClientRect||o===document.body)return mt();if(e||t)return o;e=!0}}while(o=o.parentNode);return mt()}function tr(n,t){if(n&&t)for(var o in t)t.hasOwnProperty(o)&&(n[o]=t[o]);return n}function ve(n,t){return Math.round(n.top)===Math.round(t.top)&&Math.round(n.left)===Math.round(t.left)&&Math.round(n.height)===Math.round(t.height)&&Math.round(n.width)===Math.round(t.width)}var Yt;function on(n,t){return function(){if(!Yt){var o=arguments,e=this;o.length===1?n.call(e,o[0]):n.apply(e,o),Yt=setTimeout(function(){Yt=void 0},t)}}}function er(){clearTimeout(Yt),Yt=void 0}function rn(n,t,o){n.scrollLeft+=t,n.scrollTop+=o}function sn(n){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(n).cloneNode(!0):o?o(n).clone(!0)[0]:n.cloneNode(!0)}var st="Sortable"+new Date().getTime();function nr(){var n=[],t;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var e=[].slice.call(this.el.children);e.forEach(function(i){if(!(k(i,"display")==="none"||i===E.ghost)){n.push({target:i,rect:G(i)});var a=pt({},n[n.length-1].rect);if(i.thisAnimationDuration){var l=jt(i,!0);l&&(a.top-=l.f,a.left-=l.e)}i.fromRect=a}})}},addAnimationState:function(e){n.push(e)},removeAnimationState:function(e){n.splice(Qo(n,{target:e}),1)},animateAll:function(e){var i=this;if(!this.options.animation){clearTimeout(t),typeof e=="function"&&e();return}var a=!1,l=0;n.forEach(function(d){var u=0,c=d.target,s=c.fromRect,f=G(c),w=c.prevFromRect,C=c.prevToRect,D=d.rect,_=jt(c,!0);_&&(f.top-=_.f,f.left-=_.e),c.toRect=f,c.thisAnimationDuration&&ve(w,f)&&!ve(s,f)&&(D.top-f.top)/(D.left-f.left)===(s.top-f.top)/(s.left-f.left)&&(u=rr(D,w,C,i.options)),ve(f,s)||(c.prevFromRect=s,c.prevToRect=f,u||(u=i.options.animation),i.animate(c,D,f,u)),u&&(a=!0,l=Math.max(l,u),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},u),c.thisAnimationDuration=u)}),clearTimeout(t),a?t=setTimeout(function(){typeof e=="function"&&e()},l):typeof e=="function"&&e(),n=[]},animate:function(e,i,a,l){if(l){k(e,"transition",""),k(e,"transform","");var d=jt(this.el),u=d&&d.a,c=d&&d.d,s=(i.left-a.left)/(u||1),f=(i.top-a.top)/(c||1);e.animatingX=!!s,e.animatingY=!!f,k(e,"transform","translate3d("+s+"px,"+f+"px,0)"),this.forRepaintDummy=or(e),k(e,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),k(e,"transform","translate3d(0,0,0)"),typeof e.animated=="number"&&clearTimeout(e.animated),e.animated=setTimeout(function(){k(e,"transition",""),k(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},l)}}}}function or(n){return n.offsetWidth}function rr(n,t,o,e){return Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*e.animation}var Mt=[],be={initializeByDefault:!0},Wt={mount:function(t){for(var o in be)be.hasOwnProperty(o)&&!(o in t)&&(t[o]=be[o]);Mt.forEach(function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Mt.push(t)},pluginEvent:function(t,o,e){var i=this;this.eventCanceled=!1,e.cancel=function(){i.eventCanceled=!0};var a=t+"Global";Mt.forEach(function(l){o[l.pluginName]&&(o[l.pluginName][a]&&o[l.pluginName][a](pt({sortable:o},e)),o.options[l.pluginName]&&o[l.pluginName][t]&&o[l.pluginName][t](pt({sortable:o},e)))})},initializePlugins:function(t,o,e,i){Mt.forEach(function(d){var u=d.pluginName;if(!(!t.options[u]&&!d.initializeByDefault)){var c=new d(t,o,t.options);c.sortable=t,c.options=t.options,t[u]=c,yt(e,c.defaults)}});for(var a in t.options)if(t.options.hasOwnProperty(a)){var l=this.modifyOption(t,a,t.options[a]);typeof l<"u"&&(t.options[a]=l)}},getEventProperties:function(t,o){var e={};return Mt.forEach(function(i){typeof i.eventProperties=="function"&&yt(e,i.eventProperties.call(o[i.pluginName],t))}),e},modifyOption:function(t,o,e){var i;return Mt.forEach(function(a){t[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[o]=="function"&&(i=a.optionListeners[o].call(t[a.pluginName],e))}),i}};function ir(n){var t=n.sortable,o=n.rootEl,e=n.name,i=n.targetEl,a=n.cloneEl,l=n.toEl,d=n.fromEl,u=n.oldIndex,c=n.newIndex,s=n.oldDraggableIndex,f=n.newDraggableIndex,w=n.originalEvent,C=n.putSortable,D=n.extraEventProperties;if(t=t||o&&o[st],!!t){var _,y=t.options,S="on"+e.charAt(0).toUpperCase()+e.substr(1);window.CustomEvent&&!xt&&!Gt?_=new CustomEvent(e,{bubbles:!0,cancelable:!0}):(_=document.createEvent("Event"),_.initEvent(e,!0,!0)),_.to=l||o,_.from=d||o,_.item=i||o,_.clone=a,_.oldIndex=u,_.newIndex=c,_.oldDraggableIndex=s,_.newDraggableIndex=f,_.originalEvent=w,_.pullMode=C?C.lastPutMode:void 0;var I=pt(pt({},D),Wt.getEventProperties(e,t));for(var N in I)_[N]=I[N];o&&o.dispatchEvent(_),y[S]&&y[S].call(t,_)}}var sr=["evt"],nt=function(t,o){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=e.evt,a=qo(e,sr);Wt.pluginEvent.bind(E)(t,o,pt({dragEl:h,parentEl:Y,ghostEl:T,rootEl:U,nextEl:At,lastDownEl:re,cloneEl:z,cloneHidden:wt,dragStarted:Lt,putSortable:q,activeSortable:E.active,originalEvent:i,oldIndex:Nt,oldDraggableIndex:zt,newIndex:it,newDraggableIndex:_t,hideGhostForTarget:un,unhideGhostForTarget:cn,cloneNowHidden:function(){wt=!0},cloneNowShown:function(){wt=!1},dispatchSortableEvent:function(d){et({sortable:o,name:d,originalEvent:i})}},a))};function et(n){ir(pt({putSortable:q,cloneEl:z,targetEl:h,rootEl:U,oldIndex:Nt,oldDraggableIndex:zt,newIndex:it,newDraggableIndex:_t},n))}var h,Y,T,U,At,re,z,wt,Nt,it,zt,_t,Jt,q,Pt=!1,de=!1,ue=[],Tt,ct,ye,xe,Ge,We,Lt,Ft,$t,Ht=!1,Qt=!1,ie,tt,_e=[],Ae=!1,ce=[],ge=typeof document<"u",te=tn,qe=Gt||xt?"cssFloat":"float",ar=ge&&!Zo&&!tn&&"draggable"in document.createElement("div"),an=function(){if(ge){if(xt)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),ln=function(t,o){var e=k(t),i=parseInt(e.width)-parseInt(e.paddingLeft)-parseInt(e.paddingRight)-parseInt(e.borderLeftWidth)-parseInt(e.borderRightWidth),a=Vt(t,0,o),l=Vt(t,1,o),d=a&&k(a),u=l&&k(l),c=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+G(a).width,s=u&&parseInt(u.marginLeft)+parseInt(u.marginRight)+G(l).width;if(e.display==="flex")return e.flexDirection==="column"||e.flexDirection==="column-reverse"?"vertical":"horizontal";if(e.display==="grid")return e.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&d.float&&d.float!=="none"){var f=d.float==="left"?"left":"right";return l&&(u.clear==="both"||u.clear===f)?"vertical":"horizontal"}return a&&(d.display==="block"||d.display==="flex"||d.display==="table"||d.display==="grid"||c>=i&&e[qe]==="none"||l&&e[qe]==="none"&&c+s>i)?"vertical":"horizontal"},lr=function(t,o,e){var i=e?t.left:t.top,a=e?t.right:t.bottom,l=e?t.width:t.height,d=e?o.left:o.top,u=e?o.right:o.bottom,c=e?o.width:o.height;return i===d||a===u||i+l/2===d+c/2},dr=function(t,o){var e;return ue.some(function(i){var a=i[st].options.emptyInsertThreshold;if(!(!a||Ve(i))){var l=G(i),d=t>=l.left-a&&t<=l.right+a,u=o>=l.top-a&&o<=l.bottom+a;if(d&&u)return e=i}}),e},dn=function(t){function o(a,l){return function(d,u,c,s){var f=d.options.group.name&&u.options.group.name&&d.options.group.name===u.options.group.name;if(a==null&&(l||f))return!0;if(a==null||a===!1)return!1;if(l&&a==="clone")return a;if(typeof a=="function")return o(a(d,u,c,s),l)(d,u,c,s);var w=(l?d:u).options.group.name;return a===!0||typeof a=="string"&&a===w||a.join&&a.indexOf(w)>-1}}var e={},i=t.group;(!i||oe(i)!="object")&&(i={name:i}),e.name=i.name,e.checkPull=o(i.pull,!0),e.checkPut=o(i.put),e.revertClone=i.revertClone,t.group=e},un=function(){!an&&T&&k(T,"display","none")},cn=function(){!an&&T&&k(T,"display","")};ge&&document.addEventListener("click",function(n){if(de)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),de=!1,!1},!0);var It=function(t){if(h){t=t.touches?t.touches[0]:t;var o=dr(t.clientX,t.clientY);if(o){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.target=e.rootEl=o,e.preventDefault=void 0,e.stopPropagation=void 0,o[st]._onDragOver(e)}}},ur=function(t){h&&h.parentNode[st]._isOutsideThisEl(t.target)};function E(n,t){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=t=yt({},t),n[st]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ln(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,d){l.setData("Text",d.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:E.supportPointer!==!1&&"PointerEvent"in window&&!Xt,emptyInsertThreshold:5};Wt.initializePlugins(this,n,o);for(var e in o)!(e in t)&&(t[e]=o[e]);dn(t);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=t.forceFallback?!1:ar,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?j(n,"pointerdown",this._onTapStart):(j(n,"mousedown",this._onTapStart),j(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(j(n,"dragover",this),j(n,"dragenter",this)),ue.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),yt(this,nr())}E.prototype={constructor:E,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Ft=null)},_getDirection:function(t,o){return typeof this.options.direction=="function"?this.options.direction.call(this,t,o,h):this.options.direction},_onTapStart:function(t){if(t.cancelable){var o=this,e=this.el,i=this.options,a=i.preventOnFilter,l=t.type,d=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,u=(d||t).target,c=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||u,s=i.filter;if(br(e),!h&&!(/mousedown|pointerdown/.test(l)&&t.button!==0||i.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Xt&&u&&u.tagName.toUpperCase()==="SELECT")&&(u=ht(u,i.draggable,e,!1),!(u&&u.animated)&&re!==u)){if(Nt=lt(u),zt=lt(u,i.draggable),typeof s=="function"){if(s.call(this,t,u,this)){et({sortable:o,rootEl:c,name:"filter",targetEl:u,toEl:e,fromEl:e}),nt("filter",o,{evt:t}),a&&t.cancelable&&t.preventDefault();return}}else if(s&&(s=s.split(",").some(function(f){if(f=ht(c,f.trim(),e,!1),f)return et({sortable:o,rootEl:f,name:"filter",targetEl:u,fromEl:e,toEl:e}),nt("filter",o,{evt:t}),!0}),s)){a&&t.cancelable&&t.preventDefault();return}i.handle&&!ht(c,i.handle,e,!1)||this._prepareDragStart(t,d,u)}}},_prepareDragStart:function(t,o,e){var i=this,a=i.el,l=i.options,d=a.ownerDocument,u;if(e&&!h&&e.parentNode===a){var c=G(e);if(U=a,h=e,Y=h.parentNode,At=h.nextSibling,re=e,Jt=l.group,E.dragged=h,Tt={target:h,clientX:(o||t).clientX,clientY:(o||t).clientY},Ge=Tt.clientX-c.left,We=Tt.clientY-c.top,this._lastX=(o||t).clientX,this._lastY=(o||t).clientY,h.style["will-change"]="all",u=function(){if(nt("delayEnded",i,{evt:t}),E.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Ye&&i.nativeDraggable&&(h.draggable=!0),i._triggerDragStart(t,o),et({sortable:i,name:"choose",originalEvent:t}),ot(h,l.chosenClass,!0)},l.ignore.split(",").forEach(function(s){nn(h,s.trim(),we)}),j(d,"dragover",It),j(d,"mousemove",It),j(d,"touchmove",It),j(d,"mouseup",i._onDrop),j(d,"touchend",i._onDrop),j(d,"touchcancel",i._onDrop),Ye&&this.nativeDraggable&&(this.options.touchStartThreshold=4,h.draggable=!0),nt("delayStart",this,{evt:t}),l.delay&&(!l.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(Gt||xt))){if(E.eventCanceled){this._onDrop();return}j(d,"mouseup",i._disableDelayedDrag),j(d,"touchend",i._disableDelayedDrag),j(d,"touchcancel",i._disableDelayedDrag),j(d,"mousemove",i._delayedDragTouchMoveHandler),j(d,"touchmove",i._delayedDragTouchMoveHandler),l.supportPointer&&j(d,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(u,l.delay)}else u()}},_delayedDragTouchMoveHandler:function(t){var o=t.touches?t.touches[0]:t;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){h&&we(h),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;P(t,"mouseup",this._disableDelayedDrag),P(t,"touchend",this._disableDelayedDrag),P(t,"touchcancel",this._disableDelayedDrag),P(t,"mousemove",this._delayedDragTouchMoveHandler),P(t,"touchmove",this._delayedDragTouchMoveHandler),P(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,o){o=o||t.pointerType=="touch"&&t,!this.nativeDraggable||o?this.options.supportPointer?j(document,"pointermove",this._onTouchMove):o?j(document,"touchmove",this._onTouchMove):j(document,"mousemove",this._onTouchMove):(j(h,"dragend",this),j(U,"dragstart",this._onDragStart));try{document.selection?se(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,o){if(Pt=!1,U&&h){nt("dragStarted",this,{evt:o}),this.nativeDraggable&&j(document,"dragover",ur);var e=this.options;!t&&ot(h,e.dragClass,!1),ot(h,e.ghostClass,!0),E.active=this,t&&this._appendGhost(),et({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(ct){this._lastX=ct.clientX,this._lastY=ct.clientY,un();for(var t=document.elementFromPoint(ct.clientX,ct.clientY),o=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ct.clientX,ct.clientY),t!==o);)o=t;if(h.parentNode[st]._isOutsideThisEl(t),o)do{if(o[st]){var e=void 0;if(e=o[st]._onDragOver({clientX:ct.clientX,clientY:ct.clientY,target:t,rootEl:o}),e&&!this.options.dragoverBubble)break}t=o}while(o=o.parentNode);cn()}},_onTouchMove:function(t){if(Tt){var o=this.options,e=o.fallbackTolerance,i=o.fallbackOffset,a=t.touches?t.touches[0]:t,l=T&&jt(T,!0),d=T&&l&&l.a,u=T&&l&&l.d,c=te&&tt&&He(tt),s=(a.clientX-Tt.clientX+i.x)/(d||1)+(c?c[0]-_e[0]:0)/(d||1),f=(a.clientY-Tt.clientY+i.y)/(u||1)+(c?c[1]-_e[1]:0)/(u||1);if(!E.active&&!Pt){if(e&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<e)return;this._onDragStart(t,!0)}if(T){l?(l.e+=s-(ye||0),l.f+=f-(xe||0)):l={a:1,b:0,c:0,d:1,e:s,f};var w="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");k(T,"webkitTransform",w),k(T,"mozTransform",w),k(T,"msTransform",w),k(T,"transform",w),ye=s,xe=f,ct=a}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!T){var t=this.options.fallbackOnBody?document.body:U,o=G(h,!0,te,!0,t),e=this.options;if(te){for(tt=t;k(tt,"position")==="static"&&k(tt,"transform")==="none"&&tt!==document;)tt=tt.parentNode;tt!==document.body&&tt!==document.documentElement?(tt===document&&(tt=mt()),o.top+=tt.scrollTop,o.left+=tt.scrollLeft):tt=mt(),_e=He(tt)}T=h.cloneNode(!0),ot(T,e.ghostClass,!1),ot(T,e.fallbackClass,!0),ot(T,e.dragClass,!0),k(T,"transition",""),k(T,"transform",""),k(T,"box-sizing","border-box"),k(T,"margin",0),k(T,"top",o.top),k(T,"left",o.left),k(T,"width",o.width),k(T,"height",o.height),k(T,"opacity","0.8"),k(T,"position",te?"absolute":"fixed"),k(T,"zIndex","100000"),k(T,"pointerEvents","none"),E.ghost=T,t.appendChild(T),k(T,"transform-origin",Ge/parseInt(T.style.width)*100+"% "+We/parseInt(T.style.height)*100+"%")}},_onDragStart:function(t,o){var e=this,i=t.dataTransfer,a=e.options;if(nt("dragStart",this,{evt:t}),E.eventCanceled){this._onDrop();return}nt("setupClone",this),E.eventCanceled||(z=sn(h),z.draggable=!1,z.style["will-change"]="",this._hideClone(),ot(z,this.options.chosenClass,!1),E.clone=z),e.cloneId=se(function(){nt("clone",e),!E.eventCanceled&&(e.options.removeCloneOnHide||U.insertBefore(z,h),e._hideClone(),et({sortable:e,name:"clone"}))}),!o&&ot(h,a.dragClass,!0),o?(de=!0,e._loopId=setInterval(e._emulateDragOver,50)):(P(document,"mouseup",e._onDrop),P(document,"touchend",e._onDrop),P(document,"touchcancel",e._onDrop),i&&(i.effectAllowed="move",a.setData&&a.setData.call(e,i,h)),j(document,"drop",e),k(h,"transform","translateZ(0)")),Pt=!0,e._dragStartId=se(e._dragStarted.bind(e,o,t)),j(document,"selectstart",e),Lt=!0,Xt&&k(document.body,"user-select","none")},_onDragOver:function(t){var o=this.el,e=t.target,i,a,l,d=this.options,u=d.group,c=E.active,s=Jt===u,f=d.sort,w=q||c,C,D=this,_=!1;if(Ae)return;function y(Ct,he){nt(Ct,D,pt({evt:t,isOwner:s,axis:C?"vertical":"horizontal",revert:l,dragRect:i,targetRect:a,canSort:f,fromSortable:w,target:e,completed:I,onMove:function(qt,me){return ee(U,o,h,i,qt,G(qt),t,me)},changed:N},he))}function S(){y("dragOverAnimationCapture"),D.captureAnimationState(),D!==w&&w.captureAnimationState()}function I(Ct){return y("dragOverCompleted",{insertion:Ct}),Ct&&(s?c._hideClone():c._showClone(D),D!==w&&(ot(h,q?q.options.ghostClass:c.options.ghostClass,!1),ot(h,d.ghostClass,!0)),q!==D&&D!==E.active?q=D:D===E.active&&q&&(q=null),w===D&&(D._ignoreWhileAnimating=e),D.animateAll(function(){y("dragOverAnimationComplete"),D._ignoreWhileAnimating=null}),D!==w&&(w.animateAll(),w._ignoreWhileAnimating=null)),(e===h&&!h.animated||e===o&&!e.animated)&&(Ft=null),!d.dragoverBubble&&!t.rootEl&&e!==document&&(h.parentNode[st]._isOutsideThisEl(t.target),!Ct&&It(t)),!d.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),_=!0}function N(){it=lt(h),_t=lt(h,d.draggable),et({sortable:D,name:"change",toEl:o,newIndex:it,newDraggableIndex:_t,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),e=ht(e,d.draggable,o,!0),y("dragOver"),E.eventCanceled)return _;if(h.contains(t.target)||e.animated&&e.animatingX&&e.animatingY||D._ignoreWhileAnimating===e)return I(!1);if(de=!1,c&&!d.disabled&&(s?f||(l=Y!==U):q===this||(this.lastPutMode=Jt.checkPull(this,c,h,t))&&u.checkPut(this,c,h,t))){if(C=this._getDirection(t,e)==="vertical",i=G(h),y("dragOverValid"),E.eventCanceled)return _;if(l)return Y=U,S(),this._hideClone(),y("revert"),E.eventCanceled||(At?U.insertBefore(h,At):U.appendChild(h)),I(!0);var L=Ve(o,d.draggable);if(!L||hr(t,C,this)&&!L.animated){if(L===h)return I(!1);if(L&&o===t.target&&(e=L),e&&(a=G(e)),ee(U,o,h,i,e,a,t,!!e)!==!1)return S(),o.appendChild(h),Y=o,N(),I(!0)}else if(L&&gr(t,C,this)){var W=Vt(o,0,d,!0);if(W===h)return I(!1);if(e=W,a=G(e),ee(U,o,h,i,e,a,t,!1)!==!1)return S(),o.insertBefore(h,W),Y=o,N(),I(!0)}else if(e.parentNode===o){a=G(e);var X=0,dt,A=h.parentNode!==o,g=!lr(h.animated&&h.toRect||i,e.animated&&e.toRect||a,C),x=C?"top":"left",V=$e(e,"top","top")||$e(h,"top","top"),ut=V?V.scrollTop:void 0;Ft!==e&&(dt=a[x],Ht=!1,Qt=!g&&d.invertSwap||A),X=mr(t,e,a,C,g?1:d.swapThreshold,d.invertedSwapThreshold==null?d.swapThreshold:d.invertedSwapThreshold,Qt,Ft===e);var J;if(X!==0){var at=lt(h);do at-=X,J=Y.children[at];while(J&&(k(J,"display")==="none"||J===T))}if(X===0||J===e)return I(!1);Ft=e,$t=X;var ft=e.nextElementSibling,gt=!1;gt=X===1;var Ot=ee(U,o,h,i,e,a,t,gt);if(Ot!==!1)return(Ot===1||Ot===-1)&&(gt=Ot===1),Ae=!0,setTimeout(fr,30),S(),gt&&!ft?o.appendChild(h):e.parentNode.insertBefore(h,gt?ft:e),V&&rn(V,0,ut-V.scrollTop),Y=h.parentNode,dt!==void 0&&!Qt&&(ie=Math.abs(dt-G(e)[x])),N(),I(!0)}if(o.contains(h))return I(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){P(document,"mousemove",this._onTouchMove),P(document,"touchmove",this._onTouchMove),P(document,"pointermove",this._onTouchMove),P(document,"dragover",It),P(document,"mousemove",It),P(document,"touchmove",It)},_offUpEvents:function(){var t=this.el.ownerDocument;P(t,"mouseup",this._onDrop),P(t,"touchend",this._onDrop),P(t,"pointerup",this._onDrop),P(t,"touchcancel",this._onDrop),P(document,"selectstart",this)},_onDrop:function(t){var o=this.el,e=this.options;if(it=lt(h),_t=lt(h,e.draggable),nt("drop",this,{evt:t}),Y=h&&h.parentNode,it=lt(h),_t=lt(h,e.draggable),E.eventCanceled){this._nulling();return}Pt=!1,Qt=!1,Ht=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Oe(this.cloneId),Oe(this._dragStartId),this.nativeDraggable&&(P(document,"drop",this),P(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Xt&&k(document.body,"user-select",""),k(h,"transform",""),t&&(Lt&&(t.cancelable&&t.preventDefault(),!e.dropBubble&&t.stopPropagation()),T&&T.parentNode&&T.parentNode.removeChild(T),(U===Y||q&&q.lastPutMode!=="clone")&&z&&z.parentNode&&z.parentNode.removeChild(z),h&&(this.nativeDraggable&&P(h,"dragend",this),we(h),h.style["will-change"]="",Lt&&!Pt&&ot(h,q?q.options.ghostClass:this.options.ghostClass,!1),ot(h,this.options.chosenClass,!1),et({sortable:this,name:"unchoose",toEl:Y,newIndex:null,newDraggableIndex:null,originalEvent:t}),U!==Y?(it>=0&&(et({rootEl:Y,name:"add",toEl:Y,fromEl:U,originalEvent:t}),et({sortable:this,name:"remove",toEl:Y,originalEvent:t}),et({rootEl:Y,name:"sort",toEl:Y,fromEl:U,originalEvent:t}),et({sortable:this,name:"sort",toEl:Y,originalEvent:t})),q&&q.save()):it!==Nt&&it>=0&&(et({sortable:this,name:"update",toEl:Y,originalEvent:t}),et({sortable:this,name:"sort",toEl:Y,originalEvent:t})),E.active&&((it==null||it===-1)&&(it=Nt,_t=zt),et({sortable:this,name:"end",toEl:Y,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){nt("nulling",this),U=h=Y=T=At=z=re=wt=Tt=ct=Lt=it=_t=Nt=zt=Ft=$t=q=Jt=E.dragged=E.ghost=E.clone=E.active=null,ce.forEach(function(t){t.checked=!0}),ce.length=ye=xe=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":h&&(this._onDragOver(t),cr(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],o,e=this.el.children,i=0,a=e.length,l=this.options;i<a;i++)o=e[i],ht(o,l.draggable,this.el,!1)&&t.push(o.getAttribute(l.dataIdAttr)||vr(o));return t},sort:function(t,o){var e={},i=this.el;this.toArray().forEach(function(a,l){var d=i.children[l];ht(d,this.options.draggable,i,!1)&&(e[a]=d)},this),o&&this.captureAnimationState(),t.forEach(function(a){e[a]&&(i.removeChild(e[a]),i.appendChild(e[a]))}),o&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,o){return ht(t,o||this.options.draggable,this.el,!1)},option:function(t,o){var e=this.options;if(o===void 0)return e[t];var i=Wt.modifyOption(this,t,o);typeof i<"u"?e[t]=i:e[t]=o,t==="group"&&dn(e)},destroy:function(){nt("destroy",this);var t=this.el;t[st]=null,P(t,"mousedown",this._onTapStart),P(t,"touchstart",this._onTapStart),P(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(P(t,"dragover",this),P(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ue.splice(ue.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!wt){if(nt("hideClone",this),E.eventCanceled)return;k(z,"display","none"),this.options.removeCloneOnHide&&z.parentNode&&z.parentNode.removeChild(z),wt=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(wt){if(nt("showClone",this),E.eventCanceled)return;h.parentNode==U&&!this.options.group.revertClone?U.insertBefore(z,h):At?U.insertBefore(z,At):U.appendChild(z),this.options.group.revertClone&&this.animate(h,z),k(z,"display",""),wt=!1}}};function cr(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function ee(n,t,o,e,i,a,l,d){var u,c=n[st],s=c.options.onMove,f;return window.CustomEvent&&!xt&&!Gt?u=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(u=document.createEvent("Event"),u.initEvent("move",!0,!0)),u.to=t,u.from=n,u.dragged=o,u.draggedRect=e,u.related=i||t,u.relatedRect=a||G(t),u.willInsertAfter=d,u.originalEvent=l,n.dispatchEvent(u),s&&(f=s.call(c,u,l)),f}function we(n){n.draggable=!1}function fr(){Ae=!1}function gr(n,t,o){var e=G(Vt(o.el,0,o.options,!0)),i=10;return t?n.clientX<e.left-i||n.clientY<e.top&&n.clientX<e.right:n.clientY<e.top-i||n.clientY<e.bottom&&n.clientX<e.left}function hr(n,t,o){var e=G(Ve(o.el,o.options.draggable)),i=10;return t?n.clientX>e.right+i||n.clientX<=e.right&&n.clientY>e.bottom&&n.clientX>=e.left:n.clientX>e.right&&n.clientY>e.top||n.clientX<=e.right&&n.clientY>e.bottom+i}function mr(n,t,o,e,i,a,l,d){var u=e?n.clientY:n.clientX,c=e?o.height:o.width,s=e?o.top:o.left,f=e?o.bottom:o.right,w=!1;if(!l){if(d&&ie<c*i){if(!Ht&&($t===1?u>s+c*a/2:u<f-c*a/2)&&(Ht=!0),Ht)w=!0;else if($t===1?u<s+ie:u>f-ie)return-$t}else if(u>s+c*(1-i)/2&&u<f-c*(1-i)/2)return pr(t)}return w=w||l,w&&(u<s+c*a/2||u>f-c*a/2)?u>s+c/2?1:-1:0}function pr(n){return lt(h)<lt(n)?1:-1}function vr(n){for(var t=n.tagName+n.className+n.src+n.href+n.textContent,o=t.length,e=0;o--;)e+=t.charCodeAt(o);return e.toString(36)}function br(n){ce.length=0;for(var t=n.getElementsByTagName("input"),o=t.length;o--;){var e=t[o];e.checked&&ce.push(e)}}function se(n){return setTimeout(n,0)}function Oe(n){return clearTimeout(n)}ge&&j(document,"touchmove",function(n){(E.active||Pt)&&n.cancelable&&n.preventDefault()});E.utils={on:j,off:P,css:k,find:nn,is:function(t,o){return!!ht(t,o,t,!1)},extend:tr,throttle:on,closest:ht,toggleClass:ot,clone:sn,index:lt,nextTick:se,cancelNextTick:Oe,detectDirection:ln,getChild:Vt};E.get=function(n){return n[st]};E.mount=function(){for(var n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(E.utils=pt(pt({},E.utils),e.utils)),Wt.mount(e)})};E.create=function(n,t){return new E(n,t)};E.version=Ko;var $=[],Rt,Me,Fe=!1,ke,Ee,fe,Ut;function yr(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return n.prototype={dragStarted:function(o){var e=o.originalEvent;this.sortable.nativeDraggable?j(document,"dragover",this._handleAutoScroll):this.options.supportPointer?j(document,"pointermove",this._handleFallbackAutoScroll):e.touches?j(document,"touchmove",this._handleFallbackAutoScroll):j(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var e=o.originalEvent;!this.options.dragOverBubble&&!e.rootEl&&this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?P(document,"dragover",this._handleAutoScroll):(P(document,"pointermove",this._handleFallbackAutoScroll),P(document,"touchmove",this._handleFallbackAutoScroll),P(document,"mousemove",this._handleFallbackAutoScroll)),Ke(),ae(),er()},nulling:function(){fe=Me=Rt=Fe=Ut=ke=Ee=null,$.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,e){var i=this,a=(o.touches?o.touches[0]:o).clientX,l=(o.touches?o.touches[0]:o).clientY,d=document.elementFromPoint(a,l);if(fe=o,e||this.options.forceAutoScrollFallback||Gt||xt||Xt){Ce(o,this.options,d,e);var u=Et(d,!0);Fe&&(!Ut||a!==ke||l!==Ee)&&(Ut&&Ke(),Ut=setInterval(function(){var c=Et(document.elementFromPoint(a,l),!0);c!==u&&(u=c,ae()),Ce(o,i.options,c,e)},10),ke=a,Ee=l)}else{if(!this.options.bubbleScroll||Et(d,!0)===mt()){ae();return}Ce(o,this.options,Et(d,!1),!1)}}},yt(n,{pluginName:"scroll",initializeByDefault:!0})}function ae(){$.forEach(function(n){clearInterval(n.pid)}),$=[]}function Ke(){clearInterval(Ut)}var Ce=on(function(n,t,o,e){if(t.scroll){var i=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,l=t.scrollSensitivity,d=t.scrollSpeed,u=mt(),c=!1,s;Me!==o&&(Me=o,ae(),Rt=t.scroll,s=t.scrollFn,Rt===!0&&(Rt=Et(o,!0)));var f=0,w=Rt;do{var C=w,D=G(C),_=D.top,y=D.bottom,S=D.left,I=D.right,N=D.width,L=D.height,W=void 0,X=void 0,dt=C.scrollWidth,A=C.scrollHeight,g=k(C),x=C.scrollLeft,V=C.scrollTop;C===u?(W=N<dt&&(g.overflowX==="auto"||g.overflowX==="scroll"||g.overflowX==="visible"),X=L<A&&(g.overflowY==="auto"||g.overflowY==="scroll"||g.overflowY==="visible")):(W=N<dt&&(g.overflowX==="auto"||g.overflowX==="scroll"),X=L<A&&(g.overflowY==="auto"||g.overflowY==="scroll"));var ut=W&&(Math.abs(I-i)<=l&&x+N<dt)-(Math.abs(S-i)<=l&&!!x),J=X&&(Math.abs(y-a)<=l&&V+L<A)-(Math.abs(_-a)<=l&&!!V);if(!$[f])for(var at=0;at<=f;at++)$[at]||($[at]={});($[f].vx!=ut||$[f].vy!=J||$[f].el!==C)&&($[f].el=C,$[f].vx=ut,$[f].vy=J,clearInterval($[f].pid),(ut!=0||J!=0)&&(c=!0,$[f].pid=setInterval((function(){e&&this.layer===0&&E.active._onTouchMove(fe);var ft=$[this.layer].vy?$[this.layer].vy*d:0,gt=$[this.layer].vx?$[this.layer].vx*d:0;typeof s=="function"&&s.call(E.dragged.parentNode[st],gt,ft,n,fe,$[this.layer].el)!=="continue"||rn($[this.layer].el,gt,ft)}).bind({layer:f}),24))),f++}while(t.bubbleScroll&&w!==u&&(w=Et(w,!1)));Fe=c}},30),fn=function(t){var o=t.originalEvent,e=t.putSortable,i=t.dragEl,a=t.activeSortable,l=t.dispatchSortableEvent,d=t.hideGhostForTarget,u=t.unhideGhostForTarget;if(o){var c=e||a;d();var s=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,f=document.elementFromPoint(s.clientX,s.clientY);u(),c&&!c.el.contains(f)&&(l("spill"),this.onSpill({dragEl:i,putSortable:e}))}};function Le(){}Le.prototype={startIndex:null,dragStart:function(t){var o=t.oldDraggableIndex;this.startIndex=o},onSpill:function(t){var o=t.dragEl,e=t.putSortable;this.sortable.captureAnimationState(),e&&e.captureAnimationState();var i=Vt(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(o,i):this.sortable.el.appendChild(o),this.sortable.animateAll(),e&&e.animateAll()},drop:fn};yt(Le,{pluginName:"revertOnSpill"});function Re(){}Re.prototype={onSpill:function(t){var o=t.dragEl,e=t.putSortable,i=e||this.sortable;i.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),i.animateAll()},drop:fn};yt(Re,{pluginName:"removeOnSpill"});E.mount(new yr);E.mount(Re,Le);function xr(){return typeof window<"u"?window.console:global.console}const _r=xr();function wr(n){const t=Object.create(null);return function(e){return t[e]||(t[e]=n(e))}}const kr=/-(\w)/g,Ze=wr(n=>n.replace(kr,(t,o)=>o?o.toUpperCase():""));function De(n){n.parentElement!==null&&n.parentElement.removeChild(n)}function Je(n,t,o){const e=o===0?n.children[0]:n.children[o-1].nextSibling;n.insertBefore(t,e)}function Er(n,t){return Object.values(n).indexOf(t)}function Cr(n,t,o,e){if(!n)return[];const i=Object.values(n),a=t.length-e;return[...t].map((d,u)=>u>=a?i.length:i.indexOf(d))}function gn(n,t){this.$nextTick(()=>this.$emit(n.toLowerCase(),t))}function Dr(n){return t=>{this.realList!==null&&this["onDrag"+n](t),gn.call(this,n,t)}}function Sr(n){return["transition-group","TransitionGroup"].includes(n)}function Tr(n){if(!n||n.length!==1)return!1;const[{type:t}]=n;return t?Sr(t.name):!1}function Ir(n,t){return t?{...t.props,...t.attrs}:n}const Pe=["Start","Add","Remove","Update","End"],Ne=["Choose","Unchoose","Sort","Filter","Clone"],Ar=["Move",...Pe,...Ne].map(n=>"on"+n);let Se=null;const Or={options:Object,list:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:n=>n},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null},component:{type:String,default:null},modelValue:{type:Array,required:!1,default:null}},Mr=Fn({name:"VueDraggableNext",inheritAttrs:!1,emits:["update:modelValue","move","change",...Pe.map(n=>n.toLowerCase()),...Ne.map(n=>n.toLowerCase())],props:Or,data(){return{transitionMode:!1,noneFunctionalComponentMode:!1,headerOffset:0,footerOffset:0,_sortable:{},visibleIndexes:[],context:{}}},render(){const n=this.$slots.default?this.$slots.default():null,t=Ir(this.$attrs,this.componentData);return n?(this.transitionMode=Tr(n),Be(this.getTag(),t,n)):Be(this.getTag(),t,[])},created(){this.list!==null&&this.modelValue!==null&&_r.error("list props are mutually exclusive! Please set one.")},mounted(){const n={};Pe.forEach(i=>{n["on"+i]=Dr.call(this,i)}),Ne.forEach(i=>{n["on"+i]=gn.bind(this,i)});const t=Object.keys(this.$attrs).reduce((i,a)=>(i[Ze(a)]=this.$attrs[a],i),{}),o=Object.assign({},t,n,{onMove:(i,a)=>this.onDragMove(i,a)});!("draggable"in o)&&(o.draggable=">*");const e=this.$el.nodeType===1?this.$el:this.$el.parentElement;this._sortable=new E(e,o),e.__draggable_component__=this,this.computeIndexes()},beforeUnmount(){try{this._sortable!==void 0&&this._sortable.destroy()}catch{}},computed:{realList(){return this.list?this.list:this.modelValue}},watch:{$attrs:{handler(n){this.updateOptions(n)},deep:!0},realList(){this.computeIndexes()}},methods:{getTag(){return this.component?Te(this.component):this.tag},updateOptions(n){for(var t in n){const o=Ze(t);Ar.indexOf(o)===-1&&this._sortable.option(o,n[t])}},getChildrenNodes(){return this.$el.children},computeIndexes(){this.$nextTick(()=>{this.visibleIndexes=Cr(this.getChildrenNodes(),this.$el.children,this.transitionMode,this.footerOffset)})},getUnderlyingVm(n){const t=Er(this.getChildrenNodes()||[],n);if(t===-1)return null;const o=this.realList[t];return{index:t,element:o}},emitChanges(n){this.$nextTick(()=>{this.$emit("change",n)})},alterList(n){if(this.list){n(this.list);return}const t=[...this.modelValue];n(t),this.$emit("update:modelValue",t)},spliceList(){const n=t=>t.splice(...arguments);this.alterList(n)},updatePosition(n,t){const o=e=>e.splice(t,0,e.splice(n,1)[0]);this.alterList(o)},getVmIndex(n){const t=this.visibleIndexes,o=t.length;return n>o-1?o:t[n]},getComponent(){return this.$slots.default?this.$slots.default()[0].componentInstance:null},resetTransitionData(n){if(!this.noTransitionOnDrag||!this.transitionMode)return;var t=this.getChildrenNodes();t[n].data=null;const o=this.getComponent();o.children=[],o.kept=void 0},onDragStart(n){this.computeIndexes(),this.context=this.getUnderlyingVm(n.item),this.context&&(n.item._underlying_vm_=this.clone(this.context.element),Se=n.item)},onDragAdd(n){const t=n.item._underlying_vm_;if(t===void 0)return;De(n.item);const o=this.getVmIndex(n.newIndex);this.spliceList(o,0,t),this.computeIndexes();const e={element:t,newIndex:o};this.emitChanges({added:e})},onDragRemove(n){if(Je(this.$el,n.item,n.oldIndex),n.pullMode==="clone"){De(n.clone);return}if(!this.context)return;const t=this.context.index;this.spliceList(t,1);const o={element:this.context.element,oldIndex:t};this.resetTransitionData(t),this.emitChanges({removed:o})},onDragUpdate(n){De(n.item),Je(n.from,n.item,n.oldIndex);const t=this.context.index,o=this.getVmIndex(n.newIndex);this.updatePosition(t,o);const e={element:this.context.element,oldIndex:t,newIndex:o};this.emitChanges({moved:e})},updateProperty(n,t){n.hasOwnProperty(t)&&(n[t]+=this.headerOffset)},onDragMove(n,t){const o=this.move;if(!o||!this.realList)return!0;const e=this.getRelatedContextFromMoveEvent(n),i=this.context,a=this.computeFutureIndex(e,n);Object.assign(i,{futureIndex:a});const l=Object.assign({},n,{relatedContext:e,draggedContext:i});return o(l,t)},onDragEnd(){this.computeIndexes(),Se=null},getTrargetedComponent(n){return n.__draggable_component__},getRelatedContextFromMoveEvent({to:n,related:t}){const o=this.getTrargetedComponent(n);if(!o)return{component:o};const e=o.realList,i={list:e,component:o};if(n!==t&&e&&o.getUnderlyingVm){const a=o.getUnderlyingVm(t);if(a)return Object.assign(a,i)}return i},computeFutureIndex(n,t){const o=[...t.to.children].filter(l=>l.style.display!=="none");if(o.length===0)return 0;const e=o.indexOf(t.related),i=n.component.getVmIndex(e);return o.indexOf(Se)!==-1||!t.willInsertAfter?i:i+1}}});const Fr={class:"product-image-manager"},Pr={class:"upload-section mb-6"},Nr={class:"upload-area"},jr={key:0,class:"mt-4 space-y-2"},Vr={class:"flex justify-between items-center mb-1"},Lr={class:"text-sm text-white truncate"},Rr={class:"text-xs text-gray-400"},Ur={class:"w-full bg-gray-600 rounded-full h-2"},Br={key:0,class:"images-grid"},Xr=["src","alt"],Yr={key:0,class:"absolute top-2 left-2"},zr={class:"absolute inset-0 bg-black bg-opacity-75 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center space-x-2"},$r=["onClick"],Hr=["onClick"],Gr={class:"absolute bottom-2 right-2 bg-gray-900 bg-opacity-75 text-white text-xs px-2 py-1 rounded"},Wr={key:1,class:"text-center py-8"},qr={__name:"ProductImageManager",props:{productId:{type:Number,required:!1,default:null},initialImages:{type:Array,default:()=>[]}},emits:["imagesUpdated"],setup(n,{emit:t}){const o=Mr,e=n,i=t,a=F([...e.initialImages]),l=F([]),d=F(!1);Pn(()=>e.initialImages,_=>{a.value=[..._]});const u=_=>{const y=Array.from(_.target.files);s(y)},c=_=>{const S=Array.from(_.dataTransfer.files).filter(I=>I.type.startsWith("image/"));S.length>0&&s(S)},s=async _=>{d.value=!0;for(const y of _){if(y.size>5*1024*1024){alert(`Файл ${y.name} слишком большой. Максимальный размер: 5MB`);continue}const S={name:y.name,progress:0};l.value.push(S);try{const I=new FormData;I.append("image",y),I.append("type","product"),e.productId&&I.append("product_id",e.productId);const N=await M.post("/admin/images/upload",I,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:L=>{S.progress=Math.round(L.loaded*100/L.total)}});a.value.push(N.data.image),l.value=l.value.filter(L=>L!==S),i("imagesUpdated",a.value)}catch(I){console.error("Ошибка загрузки:",I),alert(`Ошибка загрузки файла ${y.name}`),l.value=l.value.filter(N=>N!==S)}}d.value=!1},f=async _=>{if(confirm("Удалить это изображение?"))try{await M.delete(`/admin/images/${_.id}`),a.value=a.value.filter(y=>y.id!==_.id),i("imagesUpdated",a.value)}catch(y){console.error("Ошибка удаления:",y),alert("Ошибка удаления изображения")}},w=async _=>{try{await M.post("/admin/images/set-main",{image_id:_.id}),a.value.forEach(y=>{y.is_main=y.id===_.id}),i("imagesUpdated",a.value)}catch(y){console.error("Ошибка установки главного изображения:",y),alert("Ошибка установки главного изображения")}},C=async()=>{const _=a.value.map((y,S)=>({id:y.id,sort_order:S}));try{await M.post("/admin/images/reorder",{images:_}),i("imagesUpdated",a.value)}catch(y){console.error("Ошибка изменения порядка:",y),alert("Ошибка изменения порядка изображений")}},D=_=>{_.target.src="/placeholder-image.png"};return(_,y)=>(p(),v("div",Fr,[r("div",Pr,[y[5]||(y[5]=r("h3",{class:"text-lg font-semibold text-white mb-3"},"Изображения товара",-1)),r("div",Nr,[r("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",class:"hidden",onChange:u},null,544),r("div",{onClick:y[0]||(y[0]=S=>_.$refs.fileInput.click()),onDrop:vt(c,["prevent"]),onDragover:y[1]||(y[1]=vt(()=>{},["prevent"])),onDragenter:y[2]||(y[2]=vt(()=>{},["prevent"])),class:"border-2 border-dashed border-gray-600 rounded-lg p-8 text-center cursor-pointer hover:border-blue-500 transition-colors"},y[4]||(y[4]=[r("svg",{class:"w-12 h-12 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),r("p",{class:"text-gray-300 mb-2"},"Перетащите изображения сюда или кликните для выбора",-1),r("p",{class:"text-gray-500 text-sm"},"Поддерживаются: JPG, PNG, GIF, WebP (макс. 5MB)",-1)]),32)]),l.value.length>0?(p(),v("div",jr,[(p(!0),v(K,null,Z(l.value,(S,I)=>(p(),v("div",{key:I,class:"bg-gray-700 rounded p-3"},[r("div",Vr,[r("span",Lr,b(S.name),1),r("span",Rr,b(S.progress)+"%",1)]),r("div",Ur,[r("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:Nn({width:S.progress+"%"})},null,4)])]))),128))])):B("",!0)]),a.value.length>0?(p(),v("div",Br,[y[9]||(y[9]=r("h4",{class:"text-md font-medium text-white mb-3"}," Текущие изображения (перетащите для изменения порядка) ",-1)),ne(jn(o),{modelValue:a.value,"onUpdate:modelValue":y[3]||(y[3]=S=>a.value=S),onEnd:C,"item-key":"id",class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4","ghost-class":"opacity-50",animation:"200"},{item:Ie(({element:S})=>[r("div",{class:kt(["image-item relative group bg-gray-800 rounded-lg overflow-hidden cursor-move",{"ring-2 ring-green-500":S.is_main}])},[r("img",{src:S.url,alt:S.filename,class:"w-full h-32 object-cover",onError:D},null,40,Xr),S.is_main?(p(),v("div",Yr,y[6]||(y[6]=[r("span",{class:"bg-green-600 text-white text-xs px-2 py-1 rounded"}," Главное ",-1)]))):B("",!0),r("div",zr,[S.is_main?B("",!0):(p(),v("button",{key:0,onClick:I=>w(S),class:"bg-green-600 hover:bg-green-700 text-white p-2 rounded transition-colors",title:"Сделать главным"},y[7]||(y[7]=[r("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]),8,$r)),r("button",{onClick:I=>f(S),class:"bg-red-600 hover:bg-red-700 text-white p-2 rounded transition-colors",title:"Удалить"},y[8]||(y[8]=[r("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Hr)]),r("div",Gr," #"+b(a.value.indexOf(S)+1),1)],2)]),_:1},8,["modelValue"])])):(p(),v("div",Wr,y[10]||(y[10]=[r("p",{class:"text-gray-400"},"Нет загруженных изображений",-1)])))]))}},Kr=je(qr,[["__scopeId","data-v-ac2ed4c0"]]);const Zr={name:"AdminPanel",components:{MarketplaceManager:Ho,ProductImageManager:Kr},setup(){const n=Rn(),t=F("products"),o=F(!1),e=F(!1),i=F({data:[],current_page:1,last_page:1}),a=F([]),l=F([]),d=F([]),u=F([]),c=F(null),s=F([]),f=F(null),w=F(""),C=F(""),D=F("created_at"),_=F(!1),y=F(!1),S=F(!1),I=F(!1),N=Kt({id:null,name:"",parent_id:null,sort_order:0}),L=Kt({id:null,name:""}),W=Kt({id:null,name:""}),X=Kt({id:null,attribute_id:null,value:"",sort_order:0,is_active:!0}),dt=[{id:"products",name:"Товары"},{id:"categories",name:"Категории"},{id:"themes",name:"Темы"},{id:"attributes",name:"Атрибуты"},{id:"images",name:"Изображения"},{id:"marketplaces",name:"Маркетплейсы"}],A=Vn(()=>{const m=[],O=i.value.current_page,Q=i.value.last_page;for(let R=Math.max(1,O-2);R<=Math.min(Q,O+2);R++)m.push(R);return m}),g=async()=>{try{const m=await M.get("/admin/stats");f.value=m.data}catch(m){console.error("Ошибка загрузки статистики:",m)}},x=async(m=1)=>{var O,Q;try{o.value=!0;const R={page:m,search:w.value||"",theme_id:C.value||"",sort_by:D.value||"created_at",per_page:15},H=await M.get("/admin/products",{params:R});i.value=H.data}catch(R){console.error("Ошибка загрузки товаров:",R),((O=R.response)==null?void 0:O.status)===500?alert("Ошибка сервера при загрузке товаров. Проверьте логи сервера."):((Q=R.response)==null?void 0:Q.status)===404?alert("API метод не найден. Проверьте маршруты."):alert("Ошибка загрузки товаров: "+(R.message||"Неизвестная ошибка"))}finally{o.value=!1}},V=async()=>{try{const m=await M.get("/admin/categories");a.value=m.data}catch(m){console.error("Ошибка загрузки категорий:",m)}},ut=async()=>{try{const m=await M.get("/admin/themes");l.value=m.data}catch(m){console.error("Ошибка загрузки тем:",m)}},J=async()=>{try{const m=await M.get("/admin/attributes");d.value=m.data}catch(m){console.error("Ошибка загрузки атрибутов:",m)}},at=async m=>{try{const O=await M.get(`/admin/attributes/${m}/values`);u.value=O.data.values}catch(O){console.error("Ошибка загрузки значений атрибутов:",O),u.value=[]}},ft=async()=>{try{o.value=!0;const m=await M.get("/admin/images");s.value=m.data.data||m.data}catch(m){console.error("Ошибка загрузки изображений:",m)}finally{o.value=!1}},gt=async m=>{if(confirm("Удалить этот товар? Это действие нельзя отменить."))try{await M.delete(`/admin/products/${m}`),alert("Товар удален!"),x(),g()}catch(O){console.error("Ошибка удаления товара:",O),alert("Ошибка удаления товара")}},Ot=()=>{Object.assign(N,{id:null,name:"",parent_id:null,sort_order:0}),_.value=!0},Ct=m=>{Object.assign(N,{id:m.id,name:m.name,parent_id:m.parent_id,sort_order:m.sort_order||0}),_.value=!0},he=async()=>{var m,O,Q;if(!N.name.trim()){alert("Название категории обязательно");return}if(N.id&&N.parent_id===N.id){alert("Категория не может быть родителем самой себе");return}try{e.value=!0;const R={name:N.name.trim(),parent_id:N.parent_id||null,sort_order:N.sort_order||0,meta_title:N.meta_title||null,meta_description:N.meta_description||null};let H;N.id?H=await M.put(`/admin/categories/${N.id}`,R):H=await M.post("/admin/categories",R),alert(H.data.message||"Категория сохранена!"),_.value=!1,V(),g()}catch(R){if(console.error("Ошибка сохранения категории:",R),((m=R.response)==null?void 0:m.status)===422&&R.response.data.errors){const H=R.response.data.errors,Dt=Object.values(H).flat();alert(`Ошибки валидации:
`+Dt.join(`
`))}else alert("Ошибка сохранения категории: "+(((Q=(O=R.response)==null?void 0:O.data)==null?void 0:Q.message)||R.message))}finally{e.value=!1}},Ue=async m=>{if(confirm("Удалить эту категорию? Все товары в ней потеряют категорию."))try{await M.delete(`/admin/categories/${m}`),alert("Категория удалена!"),V(),g()}catch(O){console.error("Ошибка удаления категории:",O),alert("Ошибка удаления категории")}},qt=()=>{Object.assign(L,{id:null,name:""}),y.value=!0},me=m=>{Object.assign(L,{id:m.id,name:m.name}),y.value=!0},hn=async()=>{try{e.value=!0,L.id?(await M.put(`/admin/themes/${L.id}`,L),alert("Тема обновлена!")):(await M.post("/admin/themes",L),alert("Тема создана!")),y.value=!1,ut(),g()}catch(m){console.error("Ошибка сохранения темы:",m),alert("Ошибка сохранения темы")}finally{e.value=!1}},mn=async m=>{if(confirm("Удалить эту тему? Все товары в ней потеряют тему."))try{await M.delete(`/admin/themes/${m}`),alert("Тема удалена!"),ut(),g()}catch(O){console.error("Ошибка удаления темы:",O),alert("Ошибка удаления темы")}},pn=m=>{c.value=m,at(m.id)},vn=()=>{Object.assign(W,{id:null,name:""}),S.value=!0},bn=m=>{Object.assign(W,{id:m.id,name:m.name}),S.value=!0},yn=async()=>{try{e.value=!0,W.id?(await M.put(`/admin/attributes/${W.id}`,W),alert("Атрибут обновлен!")):(await M.post("/admin/attributes",W),alert("Атрибут создан!")),S.value=!1,J()}catch(m){console.error("Ошибка сохранения атрибута:",m),alert("Ошибка сохранения атрибута")}finally{e.value=!1}},xn=async m=>{var O;if(confirm("Удалить этот атрибут? Все связанные товары потеряют этот атрибут."))try{await M.delete(`/admin/attributes/${m}`),alert("Атрибут удален!"),J(),((O=c.value)==null?void 0:O.id)===m&&(c.value=null,u.value=[])}catch(Q){console.error("Ошибка удаления атрибута:",Q),alert("Ошибка удаления атрибута")}},_n=()=>{if(!c.value){alert("Сначала выберите атрибут");return}Object.assign(X,{id:null,attribute_id:c.value.id,value:"",sort_order:0,is_active:!0}),I.value=!0},wn=m=>{Object.assign(X,{id:m.id,attribute_id:m.attribute_id,value:m.value,sort_order:m.sort_order||0,is_active:m.is_active}),I.value=!0},kn=async()=>{try{e.value=!0,X.id?(await M.put(`/admin/attribute-values/${X.id}`,X),alert("Значение обновлено!")):(await M.post(`/admin/attributes/${X.attribute_id}/values`,X),alert("Значение создано!")),I.value=!1,at(c.value.id),J()}catch(m){console.error("Ошибка сохранения значения:",m),alert("Ошибка сохранения значения")}finally{e.value=!1}},En=async m=>{if(confirm("Удалить это значение?"))try{await M.delete(`/admin/attribute-values/${m}`),alert("Значение удалено!"),at(c.value.id),J()}catch(O){console.error("Ошибка удаления значения:",O),alert("Ошибка удаления значения")}},Cn=async m=>{var Q,R;const O=m.target.files;if(O.length)try{e.value=!0;for(let H=0;H<O.length;H++){const Dt=new FormData;Dt.append("image",O[H]),Dt.append("type","product");try{const pe=await M.post("/admin/images",Dt,{headers:{"Content-Type":"multipart/form-data"},timeout:3e4});console.log(`Файл ${H+1}/${O.length} загружен:`,pe.data.filename)}catch(pe){console.error(`Ошибка загрузки файла ${O[H].name}:`,pe)}}alert(`Загрузка завершена! Обработано файлов: ${O.length}`),ft()}catch(H){console.error("Общая ошибка загрузки изображений:",H),alert("Ошибка загрузки изображений: "+(((R=(Q=H.response)==null?void 0:Q.data)==null?void 0:R.message)||H.message))}finally{e.value=!1,m.target.value=""}},Dn=async m=>{if(confirm("Удалить это изображение?"))try{await M.delete(`/admin/images/${m}`),alert("Изображение удалено!"),ft()}catch(O){console.error("Ошибка удаления изображения:",O),alert("Ошибка удаления изображения")}},Sn=m=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(m),Tn=m=>new Date(m).toLocaleDateString("ru-RU"),In=()=>{w.value="",C.value="",D.value="created_at",x()},An=On(()=>{x()},500);function On(m,O){let Q;return function(...H){const Dt=()=>{clearTimeout(Q),m(...H)};clearTimeout(Q),Q=setTimeout(Dt,O)}}const Mn=async()=>{try{await M.post("/admin/logout")}catch(m){console.error("Ошибка выхода:",m)}finally{localStorage.removeItem("auth_token"),delete M.defaults.headers.common.Authorization,n.push("/admin/login")}};return Qe(()=>{g(),x(),V(),ut(),J(),ft()}),{activeTab:t,loading:o,saving:e,tabs:dt,products:i,categories:a,themes:l,attributes:d,attributeValues:u,selectedAttribute:c,images:s,stats:f,productSearch:w,productThemeFilter:C,productSort:D,showCategoryModal:_,showThemeModal:y,showAttributeModal:S,showAttributeValueModal:I,categoryForm:N,themeForm:L,attributeForm:W,attributeValueForm:X,paginationPages:A,loadProducts:x,loadCategories:V,loadThemes:ut,loadAttributes:J,loadAttributeValues:at,loadImages:ft,deleteProduct:gt,createCategory:Ot,editCategory:Ct,saveCategoryForm:he,deleteCategory:Ue,createTheme:qt,editTheme:me,saveThemeForm:hn,deleteTheme:mn,selectAttribute:pn,createAttribute:vn,editAttribute:bn,saveAttributeForm:yn,deleteAttribute:xn,createAttributeValue:_n,editAttributeValue:wn,saveAttributeValueForm:kn,deleteAttributeValue:En,uploadImages:Cn,deleteImage:Dn,formatPrice:Sn,formatDate:Tn,clearFilters:In,debouncedSearch:An,logout:Mn}}},Jr={class:"admin-panel min-h-screen bg-gray-900 p-6"},Qr={class:"max-w-7xl mx-auto"},ti={class:"flex justify-between items-center mb-8"},ei={class:"hidden lg:flex space-x-4"},ni={key:0,class:"bg-gray-800 rounded-lg p-4 text-center"},oi={class:"text-2xl font-bold text-blue-400"},ri={key:1,class:"bg-gray-800 rounded-lg p-4 text-center"},ii={class:"text-2xl font-bold text-green-400"},si={key:2,class:"bg-gray-800 rounded-lg p-4 text-center"},ai={class:"text-2xl font-bold text-purple-400"},li={class:"bg-gray-800 rounded-lg p-2 mb-8"},di={class:"flex flex-wrap space-x-1"},ui=["onClick"],ci={class:"bg-gray-800 rounded-lg p-6"},fi={key:0},gi={class:"flex justify-between items-center mb-6"},hi={class:"flex space-x-2 action-buttons"},mi=["disabled"],pi={class:"bg-gray-700 rounded-lg p-4 mb-6"},vi={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},bi=["value"],yi={class:"flex items-end"},xi={class:"bg-gray-700 rounded-lg overflow-hidden table-responsive"},_i={class:"w-full product-table"},wi={class:"px-4 py-3"},ki={class:"flex items-center space-x-3"},Ei={class:"w-12 h-12 bg-gray-500 rounded-lg flex items-center justify-center"},Ci=["src"],Di={key:1,class:"text-gray-400 text-xs"},Si={class:"text-white font-medium"},Ti={class:"text-gray-400 text-sm"},Ii={class:"px-4 py-3 text-white"},Ai={class:"px-4 py-3 text-gray-300"},Oi={class:"px-4 py-3"},Mi={class:"px-4 py-3 text-gray-300"},Fi={class:"px-4 py-3"},Pi={class:"flex justify-center space-x-2 action-buttons"},Ni=["onClick"],ji={key:0,class:"bg-gray-600 px-4 py-3 flex justify-between items-center"},Vi={class:"text-gray-300 text-sm"},Li={class:"flex space-x-2"},Ri=["onClick"],Ui={key:1},Bi={class:"flex justify-between items-center mb-6"},Xi={class:"bg-gray-700 rounded-lg overflow-hidden table-responsive"},Yi={class:"w-full category-table"},zi={class:"px-4 py-3"},$i={class:"text-white font-medium"},Hi={class:"text-gray-400 text-sm"},Gi={class:"px-4 py-3 text-gray-300"},Wi={class:"px-4 py-3 text-gray-300"},qi={class:"px-4 py-3 text-gray-300"},Ki={class:"px-4 py-3"},Zi={class:"flex justify-center space-x-2 action-buttons"},Ji=["onClick"],Qi=["onClick"],ts={key:2},es={class:"flex justify-between items-center mb-6"},ns={class:"bg-gray-700 rounded-lg overflow-hidden table-responsive"},os={class:"w-full"},rs={class:"px-4 py-3 text-white font-medium"},is={class:"px-4 py-3 text-gray-300"},ss={class:"px-4 py-3 text-gray-300"},as={class:"px-4 py-3"},ls={class:"flex justify-center space-x-2 action-buttons"},ds=["onClick"],us=["onClick"],cs={key:3},fs={class:"flex justify-between items-center mb-6"},gs={class:"form-grid"},hs={class:"bg-gray-700 rounded-lg overflow-hidden"},ms={class:"max-h-96 overflow-y-auto"},ps=["onClick"],vs={class:"flex justify-between items-center"},bs={class:"text-white font-medium"},ys={class:"text-gray-400 text-sm"},xs={key:0,class:"ml-2 px-2 py-1 bg-purple-600 text-purple-100 rounded-full text-xs"},_s={class:"flex space-x-2"},ws=["onClick"],ks=["onClick"],Es={class:"bg-gray-700 rounded-lg overflow-hidden"},Cs={class:"bg-gray-600 px-4 py-3 flex justify-between items-center"},Ds={class:"text-white font-medium"},Ss={class:"max-h-96 overflow-y-auto"},Ts={key:0},Is={class:"flex justify-between items-center"},As={class:"text-white font-medium"},Os={class:"text-gray-400 text-sm"},Ms={key:0,class:"ml-2 px-2 py-1 bg-gray-500 text-gray-200 rounded-full text-xs"},Fs={class:"flex space-x-2"},Ps=["onClick"],Ns=["onClick"],js={key:1,class:"px-4 py-8 text-center text-gray-400"},Vs={key:2,class:"px-4 py-8 text-center text-gray-400"},Ls={key:4},Rs={class:"flex justify-between items-center mb-6"},Us={class:"flex space-x-2 action-buttons"},Bs=["disabled"],Xs={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},Ys=["src"],zs={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-opacity flex items-center justify-center"},$s=["onClick"],Hs={class:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-75 text-white p-2"},Gs={class:"text-xs truncate"},Ws={key:0,class:"text-center py-12 text-gray-400"},qs={key:5,class:"marketplace-section"},Ks={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Zs={class:"bg-gray-800 rounded-lg p-6 max-w-md w-full"},Js={class:"text-xl text-white mb-4"},Qs={class:"space-y-4"},ta=["value"],ea={class:"flex justify-end space-x-3 mt-6"},na=["disabled"],oa={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},ra={class:"bg-gray-800 rounded-lg p-6 max-w-md w-full"},ia={class:"text-xl text-white mb-4"},sa={class:"space-y-4"},aa={class:"flex justify-end space-x-3 mt-6"},la=["disabled"],da={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},ua={class:"bg-gray-800 rounded-lg p-6 max-w-md w-full"},ca={class:"text-xl text-white mb-4"},fa={class:"space-y-4"},ga={class:"flex justify-end space-x-3 mt-6"},ha=["disabled"],ma={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},pa={class:"bg-gray-800 rounded-lg p-6 max-w-md w-full"},va={class:"text-xl text-white mb-4"},ba={class:"space-y-4"},ya={class:"flex items-center"},xa={class:"flex justify-end space-x-3 mt-6"},_a=["disabled"];function wa(n,t,o,e,i,a){var u,c;const l=Te("router-link"),d=Te("MarketplaceManager");return p(),v("div",Jr,[r("div",Qr,[r("div",ti,[t[37]||(t[37]=r("div",null,[r("h1",{class:"text-3xl font-bold text-white"},'Админ-панель "Стужа"'),r("p",{class:"text-gray-400 mt-1"},"Управление интернет-магазином украшений")],-1)),r("div",ei,[e.stats?(p(),v("div",ni,[r("div",oi,b(((u=e.stats.products)==null?void 0:u.total)||0),1),t[34]||(t[34]=r("div",{class:"text-gray-400 text-sm"},"Товаров",-1))])):B("",!0),e.stats?(p(),v("div",ri,[r("div",ii,b(e.stats.categories||0),1),t[35]||(t[35]=r("div",{class:"text-gray-400 text-sm"},"Категорий",-1))])):B("",!0),e.stats?(p(),v("div",si,[r("div",ai,b(((c=e.stats.products)==null?void 0:c.matryoshka)||0),1),t[36]||(t[36]=r("div",{class:"text-gray-400 text-sm"},"Матрёшек",-1))])):B("",!0)]),r("button",{onClick:t[0]||(t[0]=(...s)=>e.logout&&e.logout(...s)),class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors"}," Выйти ")]),r("div",li,[r("nav",di,[(p(!0),v(K,null,Z(e.tabs,s=>(p(),v("button",{key:s.id,onClick:f=>e.activeTab=s.id,class:kt(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",e.activeTab===s.id?"bg-blue-600 text-white":"text-gray-400 hover:bg-gray-700 hover:text-white"])},b(s.name),11,ui))),128))])]),r("div",ci,[e.activeTab==="products"?(p(),v("div",fi,[r("div",gi,[t[39]||(t[39]=r("h2",{class:"text-xl font-semibold text-white"},"Управление товарами",-1)),r("div",hi,[ne(l,{to:"/admin/products/create",class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors button"},{default:Ie(()=>t[38]||(t[38]=[Zt(" + Создать товар ")])),_:1,__:[38]}),r("button",{onClick:t[1]||(t[1]=(...s)=>e.loadProducts&&e.loadProducts(...s)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.loading},b(e.loading?"Загрузка...":"Обновить"),9,mi)])]),r("div",pi,[r("div",vi,[r("div",null,[t[40]||(t[40]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Поиск",-1)),rt(r("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>e.productSearch=s),type:"text",placeholder:"Название товара...",class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white",onInput:t[3]||(t[3]=(...s)=>e.debouncedSearch&&e.debouncedSearch(...s))},null,544),[[St,e.productSearch]])]),r("div",null,[t[42]||(t[42]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Тема",-1)),rt(r("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>e.productThemeFilter=s),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white",onChange:t[5]||(t[5]=(...s)=>e.loadProducts&&e.loadProducts(...s))},[t[41]||(t[41]=r("option",{value:""},"Все темы",-1)),(p(!0),v(K,null,Z(e.themes,s=>(p(),v("option",{key:s.id,value:s.id},b(s.name),9,bi))),128))],544),[[Bt,e.productThemeFilter]])]),r("div",null,[t[44]||(t[44]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Сортировка",-1)),rt(r("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>e.productSort=s),class:"w-full bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 text-white",onChange:t[7]||(t[7]=(...s)=>e.loadProducts&&e.loadProducts(...s))},t[43]||(t[43]=[r("option",{value:"created_at"},"По дате создания",-1),r("option",{value:"name"},"По названию",-1),r("option",{value:"price"},"По цене",-1)]),544),[[Bt,e.productSort]])]),r("div",yi,[r("button",{onClick:t[8]||(t[8]=(...s)=>e.clearFilters&&e.clearFilters(...s)),class:"bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded-lg transition-colors w-full"}," Сбросить ")])])]),r("div",xi,[r("table",_i,[t[46]||(t[46]=r("thead",{class:"bg-gray-600"},[r("tr",null,[r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Товар"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Цена"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Тема"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Тип"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Дата"),r("th",{class:"px-4 py-3 text-center text-white font-medium"},"Действия")])],-1)),r("tbody",null,[(p(!0),v(K,null,Z(e.products.data,s=>{var f;return p(),v("tr",{key:s.id,class:"border-t border-gray-600 hover:bg-gray-600"},[r("td",wi,[r("div",ki,[r("div",Ei,[s.main_image?(p(),v("img",{key:0,src:`/storage/images/products/${s.main_image}`,class:"w-full h-full object-cover rounded-lg",onError:t[9]||(t[9]=w=>w.target.style.display="none")},null,40,Ci)):(p(),v("span",Di,"Нет фото"))]),r("div",null,[r("div",Si,b(s.name),1),r("div",Ti,b(s.slug),1)])])]),r("td",Ii,b(e.formatPrice(s.price)),1),r("td",Ai,b(((f=s.theme)==null?void 0:f.name)||"Без темы"),1),r("td",Oi,[r("span",{class:kt(["px-2 py-1 rounded-full text-xs font-medium",s.use_matryoshka?"bg-purple-600 text-purple-100":"bg-blue-600 text-blue-100"])},b(s.use_matryoshka?"Матрёшка":"Обычный"),3)]),r("td",Mi,b(e.formatDate(s.created_at)),1),r("td",Fi,[r("div",Pi,[ne(l,{to:`/admin/products/edit/${s.id}`,class:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors button"},{default:Ie(()=>t[45]||(t[45]=[Zt(" Редактировать ")])),_:2,__:[45]},1032,["to"]),r("button",{onClick:w=>e.deleteProduct(s.id),class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Удалить ",8,Ni)])])])}),128))])]),e.products.last_page>1?(p(),v("div",ji,[r("div",Vi," Показано "+b(e.products.from)+"-"+b(e.products.to)+" из "+b(e.products.total),1),r("div",Li,[(p(!0),v(K,null,Z(e.paginationPages,s=>(p(),v("button",{key:s,onClick:f=>e.loadProducts(s),class:kt(["px-3 py-1 rounded text-sm transition-colors",s===e.products.current_page?"bg-blue-600 text-white":"bg-gray-500 text-gray-300 hover:bg-gray-400"])},b(s),11,Ri))),128))])])):B("",!0)])])):B("",!0),e.activeTab==="categories"?(p(),v("div",Ui,[r("div",Bi,[t[47]||(t[47]=r("h2",{class:"text-xl font-semibold text-white"},"Управление категориями",-1)),r("button",{onClick:t[10]||(t[10]=(...s)=>e.createCategory&&e.createCategory(...s)),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors"}," + Создать категорию ")]),r("div",Xi,[r("table",Yi,[t[48]||(t[48]=r("thead",{class:"bg-gray-600"},[r("tr",null,[r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Название"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Родитель"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Товаров"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Порядок"),r("th",{class:"px-4 py-3 text-center text-white font-medium"},"Действия")])],-1)),r("tbody",null,[(p(!0),v(K,null,Z(e.categories,s=>{var f;return p(),v("tr",{key:s.id,class:"border-t border-gray-600 hover:bg-gray-600"},[r("td",zi,[r("div",$i,b(s.name),1),r("div",Hi,b(s.slug),1)]),r("td",Gi,b(((f=s.parent)==null?void 0:f.name)||"Корневая"),1),r("td",Wi,b(s.products_count||0),1),r("td",qi,b(s.sort_order||0),1),r("td",Ki,[r("div",Zi,[r("button",{onClick:w=>e.editCategory(s),class:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Редактировать ",8,Ji),r("button",{onClick:w=>e.deleteCategory(s.id),class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Удалить ",8,Qi)])])])}),128))])])])])):B("",!0),e.activeTab==="themes"?(p(),v("div",ts,[r("div",es,[t[49]||(t[49]=r("h2",{class:"text-xl font-semibold text-white"},"Управление темами",-1)),r("button",{onClick:t[11]||(t[11]=(...s)=>e.createTheme&&e.createTheme(...s)),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors"}," + Создать тему ")]),r("div",ns,[r("table",os,[t[50]||(t[50]=r("thead",{class:"bg-gray-600"},[r("tr",null,[r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Название"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Товаров"),r("th",{class:"px-4 py-3 text-left text-white font-medium"},"Дата создания"),r("th",{class:"px-4 py-3 text-center text-white font-medium"},"Действия")])],-1)),r("tbody",null,[(p(!0),v(K,null,Z(e.themes,s=>(p(),v("tr",{key:s.id,class:"border-t border-gray-600 hover:bg-gray-600"},[r("td",rs,b(s.name),1),r("td",is,b(s.products_count||0),1),r("td",ss,b(e.formatDate(s.created_at)),1),r("td",as,[r("div",ls,[r("button",{onClick:f=>e.editTheme(s),class:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Редактировать ",8,ds),r("button",{onClick:f=>e.deleteTheme(s.id),class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition-colors"}," Удалить ",8,us)])])]))),128))])])])])):B("",!0),e.activeTab==="attributes"?(p(),v("div",cs,[r("div",fs,[t[51]||(t[51]=r("h2",{class:"text-xl font-semibold text-white"},"Управление атрибутами",-1)),r("button",{onClick:t[12]||(t[12]=(...s)=>e.createAttribute&&e.createAttribute(...s)),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors"}," + Создать атрибут ")]),r("div",gs,[r("div",hs,[t[52]||(t[52]=r("div",{class:"bg-gray-600 px-4 py-3"},[r("h3",{class:"text-white font-medium"},"Атрибуты")],-1)),r("div",ms,[(p(!0),v(K,null,Z(e.attributes,s=>{var f;return p(),v("div",{key:s.id,class:kt(["px-4 py-3 border-b border-gray-600 hover:bg-gray-600 cursor-pointer",((f=e.selectedAttribute)==null?void 0:f.id)===s.id?"bg-gray-600":""]),onClick:w=>e.selectAttribute(s)},[r("div",vs,[r("div",null,[r("div",bs,b(s.name),1),r("div",ys,[Zt(b(s.values_count||0)+" значений, "+b(s.products_count||0)+" товаров ",1),s.is_stone?(p(),v("span",xs," Камень ")):B("",!0)])]),r("div",_s,[r("button",{onClick:vt(w=>e.editAttribute(s),["stop"]),class:"bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs transition-colors"}," Редактировать ",8,ws),r("button",{onClick:vt(w=>e.deleteAttribute(s.id),["stop"]),class:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs transition-colors"}," Удалить ",8,ks)])])],10,ps)}),128))])]),r("div",Es,[r("div",Cs,[r("h3",Ds,b(e.selectedAttribute?`Значения: ${e.selectedAttribute.name}`:"Выберите атрибут"),1),e.selectedAttribute?(p(),v("button",{key:0,onClick:t[13]||(t[13]=(...s)=>e.createAttributeValue&&e.createAttributeValue(...s)),class:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition-colors"}," + Добавить ")):B("",!0)]),r("div",Ss,[e.selectedAttribute&&e.attributeValues.length>0?(p(),v("div",Ts,[(p(!0),v(K,null,Z(e.attributeValues,s=>(p(),v("div",{key:s.id,class:"px-4 py-3 border-b border-gray-600 hover:bg-gray-600"},[r("div",Is,[r("div",null,[r("div",As,b(s.value),1),r("div",Os,[Zt(b(s.products_count||0)+" товаров ",1),s.is_active?B("",!0):(p(),v("span",Ms," Неактивен "))])]),r("div",Fs,[r("button",{onClick:f=>e.editAttributeValue(s),class:"bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs transition-colors"}," Редактировать ",8,Ps),r("button",{onClick:f=>e.deleteAttributeValue(s.id),class:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs transition-colors"}," Удалить ",8,Ns)])])]))),128))])):e.selectedAttribute?(p(),v("div",js," У этого атрибута пока нет значений ")):(p(),v("div",Vs," Выберите атрибут для просмотра его значений "))])])])])):B("",!0),e.activeTab==="images"?(p(),v("div",Ls,[r("div",Rs,[t[53]||(t[53]=r("h2",{class:"text-xl font-semibold text-white"},"Управление изображениями",-1)),r("div",Us,[r("input",{ref:"imageUpload",type:"file",multiple:"",accept:"image/*",onChange:t[14]||(t[14]=(...s)=>e.uploadImages&&e.uploadImages(...s)),class:"hidden"},null,544),r("button",{onClick:t[15]||(t[15]=s=>n.$refs.imageUpload.click()),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors clickable"}," + Загрузить изображения "),r("button",{onClick:t[16]||(t[16]=(...s)=>e.loadImages&&e.loadImages(...s)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.loading},b(e.loading?"Загрузка...":"Обновить"),9,Bs)])]),r("div",Xs,[(p(!0),v(K,null,Z(e.images,s=>(p(),v("div",{key:s.filename,class:"relative group bg-gray-700 rounded-lg overflow-hidden"},[r("img",{src:s.path,class:"w-full h-32 object-cover",onError:t[17]||(t[17]=f=>f.target.style.display="none")},null,40,Ys),r("div",zs,[r("button",{onClick:f=>e.deleteImage(s.filename),class:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-sm transition-colors opacity-0 group-hover:opacity-100"}," Удалить ",8,$s)]),r("div",Hs,[r("div",Gs,b(s.filename),1)])]))),128))]),e.images.length===0?(p(),v("div",Ws," Нет загруженных изображений ")):B("",!0)])):B("",!0),e.activeTab==="marketplaces"?(p(),v("div",qs,[ne(d)])):B("",!0)])]),e.showCategoryModal?(p(),v("div",Ks,[r("div",Zs,[r("h3",Js,b(e.categoryForm.id?"Редактировать категорию":"Создать категорию"),1),r("form",{onSubmit:t[22]||(t[22]=vt((...s)=>e.saveCategoryForm&&e.saveCategoryForm(...s),["prevent"]))},[r("div",Qs,[r("div",null,[t[54]||(t[54]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Название",-1)),rt(r("input",{"onUpdate:modelValue":t[18]||(t[18]=s=>e.categoryForm.name=s),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[St,e.categoryForm.name]])]),r("div",null,[t[56]||(t[56]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Родительская категория",-1)),rt(r("select",{"onUpdate:modelValue":t[19]||(t[19]=s=>e.categoryForm.parent_id=s),class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},[t[55]||(t[55]=r("option",{value:""},"Корневая категория",-1)),(p(!0),v(K,null,Z(e.categories,s=>(p(),v("option",{key:s.id,value:s.id},b(s.name),9,ta))),128))],512),[[Bt,e.categoryForm.parent_id]])]),r("div",null,[t[57]||(t[57]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Порядок сортировки",-1)),rt(r("input",{"onUpdate:modelValue":t[20]||(t[20]=s=>e.categoryForm.sort_order=s),type:"number",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[St,e.categoryForm.sort_order,void 0,{number:!0}]])])]),r("div",ea,[r("button",{type:"button",onClick:t[21]||(t[21]=s=>e.showCategoryModal=!1),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Отмена "),r("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.saving},b(e.saving?"Сохранение...":"Сохранить"),9,na)])],32)])])):B("",!0),e.showThemeModal?(p(),v("div",oa,[r("div",ra,[r("h3",ia,b(e.themeForm.id?"Редактировать тему":"Создать тему"),1),r("form",{onSubmit:t[25]||(t[25]=vt((...s)=>e.saveThemeForm&&e.saveThemeForm(...s),["prevent"]))},[r("div",sa,[r("div",null,[t[58]||(t[58]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Название",-1)),rt(r("input",{"onUpdate:modelValue":t[23]||(t[23]=s=>e.themeForm.name=s),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[St,e.themeForm.name]])])]),r("div",aa,[r("button",{type:"button",onClick:t[24]||(t[24]=s=>e.showThemeModal=!1),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Отмена "),r("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.saving},b(e.saving?"Сохранение...":"Сохранить"),9,la)])],32)])])):B("",!0),e.showAttributeModal?(p(),v("div",da,[r("div",ua,[r("h3",ca,b(e.attributeForm.id?"Редактировать атрибут":"Создать атрибут"),1),r("form",{onSubmit:t[28]||(t[28]=vt((...s)=>e.saveAttributeForm&&e.saveAttributeForm(...s),["prevent"]))},[r("div",fa,[r("div",null,[t[59]||(t[59]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Название",-1)),rt(r("input",{"onUpdate:modelValue":t[26]||(t[26]=s=>e.attributeForm.name=s),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[St,e.attributeForm.name]])])]),r("div",ga,[r("button",{type:"button",onClick:t[27]||(t[27]=s=>e.showAttributeModal=!1),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Отмена "),r("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.saving},b(e.saving?"Сохранение...":"Сохранить"),9,ha)])],32)])])):B("",!0),e.showAttributeValueModal?(p(),v("div",ma,[r("div",pa,[r("h3",va,b(e.attributeValueForm.id?"Редактировать значение":"Создать значение"),1),r("form",{onSubmit:t[33]||(t[33]=vt((...s)=>e.saveAttributeValueForm&&e.saveAttributeValueForm(...s),["prevent"]))},[r("div",ba,[r("div",null,[t[60]||(t[60]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Значение",-1)),rt(r("input",{"onUpdate:modelValue":t[29]||(t[29]=s=>e.attributeValueForm.value=s),type:"text",required:"",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[St,e.attributeValueForm.value]])]),r("div",null,[t[61]||(t[61]=r("label",{class:"block text-sm font-medium text-white mb-2"},"Порядок сортировки",-1)),rt(r("input",{"onUpdate:modelValue":t[30]||(t[30]=s=>e.attributeValueForm.sort_order=s),type:"number",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"},null,512),[[St,e.attributeValueForm.sort_order,void 0,{number:!0}]])]),r("div",ya,[rt(r("input",{"onUpdate:modelValue":t[31]||(t[31]=s=>e.attributeValueForm.is_active=s),type:"checkbox",id:"is_active",class:"mr-2"},null,512),[[Ln,e.attributeValueForm.is_active]]),t[62]||(t[62]=r("label",{for:"is_active",class:"text-white"},"Активно",-1))])]),r("div",xa,[r("button",{type:"button",onClick:t[32]||(t[32]=s=>e.showAttributeValueModal=!1),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors"}," Отмена "),r("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",disabled:e.saving},b(e.saving?"Сохранение...":"Сохранить"),9,_a)])],32)])])):B("",!0)])}const Ea=je(Zr,[["render",wa],["__scopeId","data-v-3de4d60d"]]);export{Ea as default};
